2021-03-18 21:25:33,366 INFO  [main] root: Creating Storage Files
2021-03-18 21:25:33,368 INFO  [main] root: File created: server2.json
2021-03-18 21:25:33,368 INFO  [main] root: File created: server2_replica_1.json
2021-03-18 21:25:33,368 INFO  [main] root: File created: server2_replica_2.json
2021-03-18 21:25:33,368 INFO  [Thread-0] root: Initialize server ...
2021-03-18 21:25:33,389 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 21:25:33,418 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 21:25:33,419 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 21:25:33,420 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 21:25:33,424 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7675774e
2021-03-18 21:25:33,428 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 21:25:33,442 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 21:25:33,450 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 21:25:33,461 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 21:25:33,462 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 21:25:33,462 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 21:25:33,479 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:50243, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:25:33,480 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:25:33,510 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,b,0,0,0,10,ffffffe8,ffffffb0,ffffffde,27,ffffffa7,d,47,5b,ffffffc5,ffffffd4,ffffffa9,17,32,6d,ffffff8b,0,0,]
2021-03-18 21:25:33,511 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd5270000b, negotiated timeout = 4000
2021-03-18 21:25:33,514 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:25:33,514 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 21:25:33,541 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270000b, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,32,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 21:25:33,545 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270000b, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,32,0  request:: '/keeper/server2,T  response:: s{32,32,1616117133514,1616117133514,0,0,0,72080397402374155,0,0,32} 
2021-03-18 21:25:33,571 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd5270000b
2021-03-18 21:25:33,572 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd5270000b
2021-03-18 21:25:33,573 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:25:33,573 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 21:25:33,573 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270000b, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,33,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{32,33,1616117133514,1616117133546,1,0,0,72080397402374155,15,0,32} 
2021-03-18 21:25:33,573 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 21:25:33,580 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,581 INFO  [Thread-0] root: Connected to localhost on port 50244
2021-03-18 21:25:33,589 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 21:25:33,590 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 21:25:33,590 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 21:25:33,591 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 21:25:33,597 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,598 INFO  [Thread-0] root: Connected to localhost on port 50247
Starting commModule
2021-03-18 21:25:33,607 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,608 INFO  [Thread-0] root: Connected to localhost on port 50250
Starting commModule
2021-03-18 21:25:33,613 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,614 INFO  [Thread-0] root: Connected to localhost on port 50252
2021-03-18 21:25:33,615 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:25:33,616 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:25:33,620 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,621 INFO  [Thread-0] root: Connected to localhost on port 50254
Starting commModule
2021-03-18 21:25:33,622 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,623 INFO  [Thread-0] root: Connected to localhost on port 50256
2021-03-18 21:25:33,624 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:25:33,630 DEBUG [Thread-6] root: Getting successors
2021-03-18 21:25:33,630 DEBUG [Thread-6] root: Got successors
2021-03-18 21:25:33,630 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50002 127.0.0.1:50001
2021-03-18 21:25:33,634 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-18 21:25:33,635 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:33,635 INFO  [Thread-6] root: Client communication module connected
2021-03-18 21:25:33,635 DEBUG [Thread-6] root: {}
2021-03-18 21:25:33,635 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-18 21:25:33,636 INFO  [Thread-0] root: Connected to localhost on port 50258
Starting commModule
2021-03-18 21:25:34,318 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,319 INFO  [Thread-0] root: Connected to localhost on port 50263
2021-03-18 21:25:34,320 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:25:34,321 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:25:34,324 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,325 INFO  [Thread-0] root: Connected to localhost on port 50265
Starting commModule
2021-03-18 21:25:34,326 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,327 INFO  [Thread-0] root: Connected to localhost on port 50267
2021-03-18 21:25:34,327 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:25:34,328 DEBUG [Thread-10] root: Getting successors
2021-03-18 21:25:34,328 DEBUG [Thread-10] root: Got successors
2021-03-18 21:25:34,328 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-18 21:25:34,329 INFO  [Thread-10] root: Client communication module connected
2021-03-18 21:25:34,329 INFO  [Thread-10] root: Client communication module connected
2021-03-18 21:25:34,329 DEBUG [Thread-10] root: {}
2021-03-18 21:25:34,330 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:25:34,337 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,338 INFO  [Thread-0] root: Connected to localhost on port 50273
2021-03-18 21:25:34,339 INFO  [Thread-11] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:25:34,340 INFO  [Thread-11] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:25:34,347 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,348 INFO  [Thread-0] root: Connected to localhost on port 50276
Starting commModule
2021-03-18 21:25:34,349 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,350 INFO  [Thread-0] root: Connected to localhost on port 50278
2021-03-18 21:25:34,351 INFO  [Thread-13] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:25:34,351 DEBUG [Thread-13] root: Getting successors
2021-03-18 21:25:34,351 DEBUG [Thread-13] root: Got successors
2021-03-18 21:25:34,352 DEBUG [Thread-13] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-18 21:25:34,352 INFO  [Thread-13] root: Client communication module connected
2021-03-18 21:25:34,353 INFO  [Thread-13] root: Client communication module connected
2021-03-18 21:25:34,353 DEBUG [Thread-13] root: {}
2021-03-18 21:25:34,353 INFO  [Thread-13] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:25:34,367 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:34,369 INFO  [Thread-0] root: Connected to localhost on port 50283
2021-03-18 21:25:34,881 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270000b after 0ms.
Starting commModule
2021-03-18 21:25:35,061 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,061 INFO  [Thread-0] root: Connected to localhost on port 50288
2021-03-18 21:25:35,062 INFO  [Thread-15] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:25:35,063 INFO  [Thread-15] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:25:35,070 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,071 INFO  [Thread-0] root: Connected to localhost on port 50291
Starting commModule
2021-03-18 21:25:35,072 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,072 INFO  [Thread-0] root: Connected to localhost on port 50293
2021-03-18 21:25:35,073 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:25:35,074 DEBUG [Thread-17] root: Getting successors
2021-03-18 21:25:35,074 DEBUG [Thread-17] root: Got successors
2021-03-18 21:25:35,074 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 21:25:35,075 INFO  [Thread-17] root: Client communication module connected
2021-03-18 21:25:35,075 INFO  [Thread-17] root: Client communication module connected
2021-03-18 21:25:35,075 DEBUG [Thread-17] root: {}
2021-03-18 21:25:35,076 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:25:35,090 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,090 INFO  [Thread-0] root: Connected to localhost on port 50302
2021-03-18 21:25:35,091 INFO  [Thread-18] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:25:35,092 INFO  [Thread-18] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:25:35,102 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,103 INFO  [Thread-0] root: Connected to localhost on port 50306
Starting commModule
2021-03-18 21:25:35,103 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,104 INFO  [Thread-0] root: Connected to localhost on port 50308
2021-03-18 21:25:35,105 INFO  [Thread-20] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:25:35,105 DEBUG [Thread-20] root: Getting successors
2021-03-18 21:25:35,105 DEBUG [Thread-20] root: Got successors
2021-03-18 21:25:35,105 DEBUG [Thread-20] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 21:25:35,106 INFO  [Thread-20] root: Client communication module connected
2021-03-18 21:25:35,106 INFO  [Thread-20] root: Client communication module connected
2021-03-18 21:25:35,107 DEBUG [Thread-20] root: {}
2021-03-18 21:25:35,107 INFO  [Thread-20] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:25:35,122 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,123 INFO  [Thread-0] root: Connected to localhost on port 50316
Starting commModule
2021-03-18 21:25:35,131 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:25:35,131 INFO  [Thread-0] root: Connected to localhost on port 50318
2021-03-18 21:25:35,131 INFO  [Thread-22] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 21:25:35,132 DEBUG [Thread-22] root: Closing the program
2021-03-18 21:25:35,132 INFO  [Thread-22] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 21:25:35,132 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 21:25:35,134 INFO  [Thread-0] root: Server stopped.
2021-03-18 21:25:35,134 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 21:47:53,122 INFO  [Thread-0] root: Initialize server ...
2021-03-18 21:47:53,135 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 21:47:53,158 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 21:47:53,159 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 21:47:53,162 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@24877fd5
2021-03-18 21:47:53,165 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 21:47:53,177 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 21:47:53,184 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 21:47:53,193 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 21:47:53,194 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 21:47:53,195 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 21:47:53,211 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:51031, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:47:53,211 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:47:53,241 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,29,0,0,0,10,71,15,17,27,ffffffe5,18,ffffffef,ffffff80,57,ffffffb9,60,ffffffdb,4d,ffffff99,45,3d,0,]
2021-03-18 21:47:53,243 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd52700029, negotiated timeout = 4000
2021-03-18 21:47:53,246 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:47:53,246 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 21:47:53,275 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700029, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,130,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 21:47:53,279 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700029, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,130,0  request:: '/keeper/server2,T  response:: s{130,130,1616118473246,1616118473246,0,0,0,72080397402374185,0,0,130} 
2021-03-18 21:47:53,307 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700029
2021-03-18 21:47:53,308 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd52700029
2021-03-18 21:47:53,310 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:47:53,310 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 21:47:53,311 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700029, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,131,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{130,131,1616118473246,1616118473281,1,0,0,72080397402374185,15,0,130} 
2021-03-18 21:47:53,311 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 21:47:53,318 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,319 INFO  [Thread-0] root: Connected to localhost on port 51032
2021-03-18 21:47:53,327 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 21:47:53,328 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 21:47:53,328 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 21:47:53,329 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 21:47:53,334 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,335 INFO  [Thread-0] root: Connected to localhost on port 51035
Starting commModule
2021-03-18 21:47:53,338 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,339 INFO  [Thread-0] root: Connected to localhost on port 51038
Starting commModule
2021-03-18 21:47:53,342 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,343 INFO  [Thread-0] root: Connected to localhost on port 51040
2021-03-18 21:47:53,344 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:47:53,345 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:47:53,348 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,348 INFO  [Thread-0] root: Connected to localhost on port 51042
Starting commModule
2021-03-18 21:47:53,349 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,350 INFO  [Thread-0] root: Connected to localhost on port 51044
2021-03-18 21:47:53,351 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:47:53,356 DEBUG [Thread-6] root: Getting successors
2021-03-18 21:47:53,356 DEBUG [Thread-6] root: Got successors
2021-03-18 21:47:53,356 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50001
2021-03-18 21:47:53,359 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-18 21:47:53,359 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,359 INFO  [Thread-6] root: Client communication module connected
2021-03-18 21:47:53,359 DEBUG [Thread-6] root: {}
2021-03-18 21:47:53,360 INFO  [Thread-0] root: Connected to localhost on port 51046
2021-03-18 21:47:53,360 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:47:53,985 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,986 INFO  [Thread-0] root: Connected to localhost on port 51051
2021-03-18 21:47:53,987 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:47:53,987 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:47:53,991 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,992 INFO  [Thread-0] root: Connected to localhost on port 51054
Starting commModule
2021-03-18 21:47:53,992 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,993 INFO  [Thread-0] root: Connected to localhost on port 51055
2021-03-18 21:47:53,994 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:47:53,994 DEBUG [Thread-10] root: Getting successors
2021-03-18 21:47:53,994 DEBUG [Thread-10] root: Got successors
2021-03-18 21:47:53,994 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-18 21:47:53,995 INFO  [Thread-10] root: Client communication module connected
2021-03-18 21:47:53,996 INFO  [Thread-10] root: Client communication module connected
2021-03-18 21:47:53,996 DEBUG [Thread-10] root: {}
2021-03-18 21:47:53,996 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:47:53,997 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:53,998 INFO  [Thread-0] root: Connected to localhost on port 51058
2021-03-18 21:47:53,998 INFO  [Thread-11] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-18 21:47:53,998 DEBUG [Thread-11] root: Input data: 
2021-03-18 21:47:53,998 DEBUG [Thread-11] root: 358343938402ebb5110716c6e836f5a3:b3638a32c297f43aa37e63bbd839fc7e
2021-03-18 21:47:53,998 DEBUG [Thread-11] root: 127.0.0.1:50002
2021-03-18 21:47:54,000 INFO  [Thread-11] root: Client communication module connected
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Host: 127.0.0.1
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Port: 50002
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Range: 358343938402ebb5110716c6e836f5a3:b3638a32c297f43aa37e63bbd839fc7e
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Starting flush data
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Finished flush data
2021-03-18 21:47:54,000 DEBUG [Thread-11] root: Closing conn
2021-03-18 21:47:54,000 INFO  [Thread-11] root: Connection closed!
2021-03-18 21:47:54,001 DEBUG [Thread-11] root: Closed conn
2021-03-18 21:47:54,001 INFO  [Thread-11] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-18 21:47:54,006 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,007 INFO  [Thread-0] root: Connected to localhost on port 51061
2021-03-18 21:47:54,007 INFO  [Thread-12] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:47:54,008 INFO  [Thread-12] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,016 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,016 INFO  [Thread-0] root: Connected to localhost on port 51065
Starting commModule
2021-03-18 21:47:54,017 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,018 INFO  [Thread-0] root: Connected to localhost on port 51066
2021-03-18 21:47:54,018 INFO  [Thread-14] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:47:54,019 DEBUG [Thread-14] root: Getting successors
2021-03-18 21:47:54,019 DEBUG [Thread-14] root: Got successors
2021-03-18 21:47:54,019 DEBUG [Thread-14] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-18 21:47:54,019 INFO  [Thread-14] root: Client communication module connected
2021-03-18 21:47:54,020 INFO  [Thread-14] root: Client communication module connected
2021-03-18 21:47:54,020 DEBUG [Thread-14] root: {}
2021-03-18 21:47:54,020 INFO  [Thread-14] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,030 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,031 INFO  [Thread-0] root: Connected to localhost on port 51070
Starting commModule
2021-03-18 21:47:54,595 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,595 INFO  [Thread-0] root: Connected to localhost on port 51076
2021-03-18 21:47:54,596 INFO  [Thread-16] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:47:54,597 INFO  [Thread-16] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,604 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,605 INFO  [Thread-0] root: Connected to localhost on port 51081
2021-03-18 21:47:54,606 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:47:54,606 DEBUG [Thread-17] root: Getting successors
2021-03-18 21:47:54,606 DEBUG [Thread-17] root: Got successors
2021-03-18 21:47:54,606 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 21:47:54,607 INFO  [Thread-17] root: Client communication module connected
2021-03-18 21:47:54,607 INFO  [Thread-17] root: Client communication module connected
2021-03-18 21:47:54,607 DEBUG [Thread-17] root: {}
2021-03-18 21:47:54,607 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,610 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,611 INFO  [Thread-0] root: Connected to localhost on port 51085
Starting commModule
2021-03-18 21:47:54,617 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,617 INFO  [Thread-0] root: Connected to localhost on port 51090
2021-03-18 21:47:54,618 INFO  [Thread-19] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:47:54,619 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd52700029 after 0ms.
2021-03-18 21:47:54,619 INFO  [Thread-19] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,629 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,629 INFO  [Thread-0] root: Connected to localhost on port 51096
2021-03-18 21:47:54,630 INFO  [Thread-20] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:47:54,630 DEBUG [Thread-20] root: Getting successors
2021-03-18 21:47:54,630 DEBUG [Thread-20] root: Got successors
2021-03-18 21:47:54,630 DEBUG [Thread-20] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 21:47:54,631 INFO  [Thread-20] root: Client communication module connected
2021-03-18 21:47:54,631 INFO  [Thread-20] root: Client communication module connected
2021-03-18 21:47:54,631 DEBUG [Thread-20] root: {}
2021-03-18 21:47:54,632 INFO  [Thread-20] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:47:54,634 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,635 INFO  [Thread-0] root: Connected to localhost on port 51100
Starting commModule
2021-03-18 21:47:54,646 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,647 INFO  [Thread-0] root: Connected to localhost on port 51104
Starting commModule
2021-03-18 21:47:54,650 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:47:54,651 INFO  [Thread-0] root: Connected to localhost on port 51106
2021-03-18 21:47:54,651 INFO  [Thread-23] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 21:47:54,651 DEBUG [Thread-23] root: Closing the program
2021-03-18 21:47:54,651 INFO  [Thread-23] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 21:47:54,652 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 21:47:54,654 INFO  [Thread-0] root: Server stopped.
2021-03-18 21:47:54,654 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 21:48:02,318 INFO  [Thread-0] root: Initialize server ...
2021-03-18 21:48:02,331 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 21:48:02,353 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 21:48:02,354 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 21:48:02,357 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@48a00dff
2021-03-18 21:48:02,361 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 21:48:02,372 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 21:48:02,379 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 21:48:02,389 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 21:48:02,390 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 21:48:02,390 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 21:48:02,408 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:51161, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:48:02,408 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 21:48:02,439 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,31,0,0,0,10,ffffffa7,fffffffb,ffffffa3,27,ffffffe6,1,0,c,59,72,ffffffb2,ffffffc9,76,ffffffc5,58,3,0,]
2021-03-18 21:48:02,441 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd52700031, negotiated timeout = 4000
2021-03-18 21:48:02,444 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:48:02,445 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 21:48:02,474 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700031, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,154,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 21:48:02,479 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700031, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,154,0  request:: '/keeper/server2,T  response:: s{154,154,1616118482445,1616118482445,0,0,0,72080397402374193,0,0,154} 
2021-03-18 21:48:02,506 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700031
2021-03-18 21:48:02,508 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd52700031
2021-03-18 21:48:02,509 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 21:48:02,509 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 21:48:02,510 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700031, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,155,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{154,155,1616118482445,1616118482480,1,0,0,72080397402374193,15,0,154} 
2021-03-18 21:48:02,510 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 21:48:02,518 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,518 INFO  [Thread-0] root: Connected to localhost on port 51162
2021-03-18 21:48:02,526 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 21:48:02,527 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 21:48:02,528 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 21:48:02,528 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 21:48:02,539 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,540 INFO  [Thread-0] root: Connected to localhost on port 51168
Starting commModule
2021-03-18 21:48:02,546 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,547 INFO  [Thread-0] root: Connected to localhost on port 51173
Starting commModule
2021-03-18 21:48:02,549 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,550 INFO  [Thread-0] root: Connected to localhost on port 51176
Starting commModule
2021-03-18 21:48:02,558 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,558 INFO  [Thread-0] root: Connected to localhost on port 51180
2021-03-18 21:48:02,559 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 21:48:02,560 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 21:48:02,563 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,564 INFO  [Thread-0] root: Connected to localhost on port 51183
Starting commModule
2021-03-18 21:48:02,570 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,571 INFO  [Thread-0] root: Connected to localhost on port 51188
Starting commModule
2021-03-18 21:48:02,572 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,572 INFO  [Thread-0] root: Connected to localhost on port 51190
2021-03-18 21:48:02,573 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 21:48:02,578 DEBUG [Thread-8] root: Getting successors
2021-03-18 21:48:02,578 DEBUG [Thread-8] root: Got successors
2021-03-18 21:48:02,578 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 21:48:02,581 INFO  [Thread-8] root: Client communication module connected
2021-03-18 21:48:02,581 INFO  [Thread-8] root: Client communication module connected
2021-03-18 21:48:02,581 DEBUG [Thread-8] root: {}
2021-03-18 21:48:02,581 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 21:48:02,590 INFO  [Thread-0] root: Server communication module connected
2021-03-18 21:48:02,591 INFO  [Thread-0] root: Connected to localhost on port 51196
2021-03-18 21:48:02,591 INFO  [Thread-9] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 21:48:02,591 DEBUG [Thread-9] root: Closing the program
2021-03-18 21:48:02,591 INFO  [Thread-9] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 21:48:02,592 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 21:48:02,594 INFO  [Thread-0] root: Server stopped.
2021-03-18 21:48:02,594 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 22:25:08,555 INFO  [main] root: Creating Storage Files
2021-03-18 22:25:08,555 INFO  [main] root: File created: server2.json
2021-03-18 22:25:08,556 INFO  [main] root: File created: server2_replica_1.json
2021-03-18 22:25:08,556 INFO  [main] root: File created: server2_replica_2.json
2021-03-18 22:25:08,556 INFO  [Thread-0] root: Initialize server ...
2021-03-18 22:25:08,572 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 22:25:08,594 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 22:25:08,595 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 22:25:08,598 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@6f049d8b
2021-03-18 22:25:08,602 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 22:25:08,614 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 22:25:08,622 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 22:25:08,631 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 22:25:08,632 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 22:25:08,633 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 22:25:08,649 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:51985, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 22:25:08,649 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 22:25:08,679 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,4f,0,0,0,10,fffffffa,79,4f,26,24,24,ffffff97,ffffffa6,ffffffe8,ffffff9d,17,ffffff9f,68,ffffffc5,ffffffff,79,0,]
2021-03-18 22:25:08,682 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd5270004f, negotiated timeout = 4000
2021-03-18 22:25:08,685 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:25:08,685 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 22:25:08,713 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270004f, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,262,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 22:25:08,718 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270004f, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,262,0  request:: '/keeper/server2,T  response:: s{262,262,1616120708685,1616120708685,0,0,0,72080397402374223,0,0,262} 
2021-03-18 22:25:08,745 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd5270004f
2021-03-18 22:25:08,746 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd5270004f
2021-03-18 22:25:08,748 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:25:08,748 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 22:25:08,749 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270004f, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,263,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{262,263,1616120708685,1616120708719,1,0,0,72080397402374223,15,0,262} 
2021-03-18 22:25:08,749 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 22:25:08,757 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:08,758 INFO  [Thread-0] root: Connected to localhost on port 51986
2021-03-18 22:25:08,766 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 22:25:08,767 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 22:25:08,767 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 22:25:08,768 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 22:25:08,769 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:08,770 INFO  [Thread-0] root: Connected to localhost on port 51987
2021-03-18 22:25:08,771 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:25:08,772 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:25:08,773 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:08,774 INFO  [Thread-0] root: Connected to localhost on port 51988
2021-03-18 22:25:08,774 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:25:08,779 DEBUG [Thread-3] root: Getting successors
2021-03-18 22:25:08,779 DEBUG [Thread-3] root: Got successors
2021-03-18 22:25:08,780 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50001
Starting commModule
2021-03-18 22:25:08,782 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:08,782 INFO  [Thread-3] root: Client communication module connected
2021-03-18 22:25:08,783 INFO  [Thread-0] root: Connected to localhost on port 51989
Starting commModule
2021-03-18 22:25:08,783 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:08,783 INFO  [Thread-3] root: Client communication module connected
2021-03-18 22:25:08,783 DEBUG [Thread-3] root: {}
2021-03-18 22:25:08,783 INFO  [Thread-0] root: Connected to localhost on port 51990
2021-03-18 22:25:08,784 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:25:09,378 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,379 INFO  [Thread-0] root: Connected to localhost on port 51994
2021-03-18 22:25:09,380 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:25:09,380 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:25:09,381 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,382 INFO  [Thread-0] root: Connected to localhost on port 51995
2021-03-18 22:25:09,383 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:25:09,383 DEBUG [Thread-7] root: Getting successors
2021-03-18 22:25:09,383 DEBUG [Thread-7] root: Got successors
2021-03-18 22:25:09,383 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50114 127.0.0.1:50001
2021-03-18 22:25:09,384 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-18 22:25:09,384 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,384 INFO  [Thread-7] root: Client communication module connected
2021-03-18 22:25:09,384 DEBUG [Thread-7] root: {}
2021-03-18 22:25:09,384 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-18 22:25:09,385 INFO  [Thread-0] root: Connected to localhost on port 51997
Starting commModule
2021-03-18 22:25:09,385 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,386 INFO  [Thread-0] root: Connected to localhost on port 51998
2021-03-18 22:25:09,390 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-18 22:25:09,390 DEBUG [Thread-9] root: Input data: 
2021-03-18 22:25:09,390 DEBUG [Thread-9] root: dcee0277eb13b76434e8dcd31a38770a:501db0583d2a0c89672750bbe7ab2782
2021-03-18 22:25:09,390 DEBUG [Thread-9] root: 127.0.0.1:50114
2021-03-18 22:25:09,391 INFO  [Thread-9] root: Client communication module connected
2021-03-18 22:25:09,391 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Port: 50114
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Range: dcee0277eb13b76434e8dcd31a38770a:501db0583d2a0c89672750bbe7ab2782
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Starting flush data
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Finished flush data
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Closing conn
2021-03-18 22:25:09,392 INFO  [Thread-9] root: Connection closed!
2021-03-18 22:25:09,392 DEBUG [Thread-9] root: Closed conn
2021-03-18 22:25:09,392 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-18 22:25:09,394 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,395 INFO  [Thread-0] root: Connected to localhost on port 52000
2021-03-18 22:25:09,395 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:25:09,396 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:25:09,400 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,401 INFO  [Thread-0] root: Connected to localhost on port 52002
2021-03-18 22:25:09,401 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:25:09,402 DEBUG [Thread-11] root: Getting successors
2021-03-18 22:25:09,402 DEBUG [Thread-11] root: Got successors
2021-03-18 22:25:09,402 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50114 127.0.0.1:50001
2021-03-18 22:25:09,402 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-18 22:25:09,403 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,403 INFO  [Thread-11] root: Client communication module connected
2021-03-18 22:25:09,403 DEBUG [Thread-11] root: {}
2021-03-18 22:25:09,404 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-18 22:25:09,404 INFO  [Thread-0] root: Connected to localhost on port 52004
Starting commModule
2021-03-18 22:25:09,414 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,415 INFO  [Thread-0] root: Connected to localhost on port 52006
Starting commModule
2021-03-18 22:25:09,987 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,987 INFO  [Thread-0] root: Connected to localhost on port 52011
2021-03-18 22:25:09,988 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:25:09,989 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:25:09,993 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:09,994 INFO  [Thread-0] root: Connected to localhost on port 52013
2021-03-18 22:25:09,994 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:25:09,995 DEBUG [Thread-15] root: Getting successors
2021-03-18 22:25:09,995 DEBUG [Thread-15] root: Got successors
2021-03-18 22:25:09,995 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50052 127.0.0.1:50114
2021-03-18 22:25:09,995 INFO  [Thread-15] root: Client communication module connected
2021-03-18 22:25:09,996 INFO  [Thread-15] root: Client communication module connected
2021-03-18 22:25:09,996 DEBUG [Thread-15] root: {}
2021-03-18 22:25:09,996 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:25:09,999 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,000 INFO  [Thread-0] root: Connected to localhost on port 52017
Starting commModule
2021-03-18 22:25:10,005 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,005 INFO  [Thread-0] root: Connected to localhost on port 52021
2021-03-18 22:25:10,006 INFO  [Thread-17] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:25:10,006 INFO  [Thread-17] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:25:10,013 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,014 INFO  [Thread-0] root: Connected to localhost on port 52024
2021-03-18 22:25:10,014 INFO  [Thread-18] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:25:10,015 DEBUG [Thread-18] root: Getting successors
2021-03-18 22:25:10,015 DEBUG [Thread-18] root: Got successors
2021-03-18 22:25:10,015 DEBUG [Thread-18] root: Propagating to: 127.0.0.1:50052 127.0.0.1:50114
2021-03-18 22:25:10,015 INFO  [Thread-18] root: Client communication module connected
2021-03-18 22:25:10,016 INFO  [Thread-18] root: Client communication module connected
2021-03-18 22:25:10,016 DEBUG [Thread-18] root: {}
2021-03-18 22:25:10,016 INFO  [Thread-18] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:25:10,020 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,021 INFO  [Thread-0] root: Connected to localhost on port 52028
Starting commModule
2021-03-18 22:25:10,032 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,032 INFO  [Thread-0] root: Connected to localhost on port 52032
Starting commModule
2021-03-18 22:25:10,043 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,043 INFO  [Thread-0] root: Connected to localhost on port 52033
2021-03-18 22:25:10,047 INFO  [Thread-21] root: Message received by server -> Status: PUT Key: 1 Value: 1
2021-03-18 22:25:10,047 DEBUG [Thread-21] root: In serve
2021-03-18 22:25:10,047 DEBUG [Thread-21] root: Checking if stopped or write locked
2021-03-18 22:25:10,047 DEBUG [Thread-21] root: PUT request being served
2021-03-18 22:25:10,047 DEBUG [Thread-21] root: Checking if it's in range
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: Got hostname and port -> 127.0.0.1:50001
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: Got metadata range: 501db0583d2a0c89672750bbe7ab2783:dcee0277eb13b76434e8dcd31a387709
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: 127.0.0.1:50114 -> 25b23b2ebb52b5a6158828d546f0f0d6:501db0583d2a0c89672750bbe7ab2782
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: 127.0.0.1:50001 -> 501db0583d2a0c89672750bbe7ab2783:dcee0277eb13b76434e8dcd31a387709
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: 127.0.0.1:50052 -> dcee0277eb13b76434e8dcd31a38770a:25b23b2ebb52b5a6158828d546f0f0d5
2021-03-18 22:25:10,056 DEBUG [Thread-21] root: Got range big ints
2021-03-18 22:25:10,057 DEBUG [Thread-21] root: Range start < range end
2021-03-18 22:25:10,057 DEBUG [Thread-21] root: Done with range check in server
2021-03-18 22:25:10,057 DEBUG [Thread-21] root: In range
2021-03-18 22:25:10,057 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:10,058 INFO  [Thread-21] root: Put: key = 1, value = 1
2021-03-18 22:25:10,059 DEBUG [Thread-21] root: Getting successors
2021-03-18 22:25:10,059 DEBUG [Thread-21] root: Got successors
2021-03-18 22:25:10,059 DEBUG [Thread-21] root: Propagating to: 127.0.0.1:50052 127.0.0.1:50114
2021-03-18 22:25:10,059 INFO  [Thread-21] root: Client communication module connected
2021-03-18 22:25:10,060 INFO  [Thread-21] root: Client communication module connected
2021-03-18 22:25:10,060 DEBUG [Thread-21] root: {"1":"1"}
2021-03-18 22:25:10,062 INFO  [Thread-21] root: Message sent by client -> Status: PROPAGATE
2021-03-18 22:25:10,063 INFO  [Thread-21] root: Message sent by client -> Status: PROPAGATE
2021-03-18 22:25:10,068 INFO  [Thread-21] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-18 22:25:10,068 INFO  [Thread-21] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-18 22:25:10,069 INFO  [Thread-21] root: Message sent by server -> Status: PUT_SUCCESS Key: 1 Value: 1
Starting commModule
2021-03-18 22:25:10,070 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:10,071 INFO  [Thread-0] root: Connected to localhost on port 52036
2021-03-18 22:25:11,392 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:12,728 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:14,067 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:15,404 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:16,741 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:18,076 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:19,412 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:20,746 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:22,082 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:23,421 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:24,760 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:26,094 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:27,429 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:28,768 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 2ms.
2021-03-18 22:25:30,103 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
2021-03-18 22:25:31,437 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 1ms.
2021-03-18 22:25:32,772 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd5270004f after 0ms.
Starting commModule
2021-03-18 22:25:33,681 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:25:33,682 INFO  [Thread-0] root: Connected to localhost on port 52046
2021-03-18 22:25:33,682 INFO  [Thread-23] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 22:25:33,682 DEBUG [Thread-23] root: Closing the program
2021-03-18 22:25:33,683 INFO  [Thread-23] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 22:25:33,683 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 22:25:33,685 INFO  [Thread-0] root: Server stopped.
2021-03-18 22:25:33,685 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 22:45:05,575 INFO  [Thread-0] root: Initialize server ...
2021-03-18 22:45:05,587 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 22:45:05,607 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 22:45:05,607 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 22:45:05,608 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 22:45:05,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7a8d20e7
2021-03-18 22:45:05,614 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 22:45:05,625 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 22:45:05,631 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 22:45:05,640 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 22:45:05,641 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/127.0.0.1:2181.
2021-03-18 22:45:05,641 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 22:45:05,656 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /127.0.0.1:53041, server: localhost/127.0.0.1:2181
2021-03-18 22:45:05,656 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/127.0.0.1:2181
2021-03-18 22:45:05,685 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,ffffff8b,0,0,0,10,5b,27,ffffffce,2a,ffffffac,3d,ffffffa1,ffffffeb,27,5a,8,64,61,3,47,76,0,]
2021-03-18 22:45:05,687 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, session id = 0x10014bd5270008b, negotiated timeout = 4000
2021-03-18 22:45:05,689 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:45:05,689 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 22:45:05,719 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270008b, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,464,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 22:45:05,723 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270008b, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,464,0  request:: '/keeper/server2,T  response:: s{464,464,1616121905689,1616121905689,0,0,0,72080397402374283,0,0,464} 
2021-03-18 22:45:05,750 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd5270008b
2021-03-18 22:45:05,751 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd5270008b
2021-03-18 22:45:05,753 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:45:05,753 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 22:45:05,754 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270008b, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,465,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{464,465,1616121905689,1616121905724,1,0,0,72080397402374283,15,0,464} 
2021-03-18 22:45:05,754 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 22:45:05,761 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,762 INFO  [Thread-0] root: Connected to localhost on port 53042
2021-03-18 22:45:05,770 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 22:45:05,771 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 22:45:05,771 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 22:45:05,771 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 22:45:05,780 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,781 INFO  [Thread-0] root: Connected to localhost on port 53046
Starting commModule
2021-03-18 22:45:05,784 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,785 INFO  [Thread-0] root: Connected to localhost on port 53050
Starting commModule
2021-03-18 22:45:05,787 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,788 INFO  [Thread-0] root: Connected to localhost on port 53052
Starting commModule
2021-03-18 22:45:05,794 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,794 INFO  [Thread-0] root: Connected to localhost on port 53055
2021-03-18 22:45:05,795 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:45:05,796 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:45:05,799 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,800 INFO  [Thread-0] root: Connected to localhost on port 53057
Starting commModule
2021-03-18 22:45:05,803 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,804 INFO  [Thread-0] root: Connected to localhost on port 53061
Starting commModule
2021-03-18 22:45:05,804 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:05,805 INFO  [Thread-0] root: Connected to localhost on port 53062
2021-03-18 22:45:05,805 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:45:05,810 DEBUG [Thread-8] root: Getting successors
2021-03-18 22:45:05,810 DEBUG [Thread-8] root: Got successors
2021-03-18 22:45:05,811 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-18 22:45:05,813 INFO  [Thread-8] root: Client communication module connected
2021-03-18 22:45:05,813 INFO  [Thread-8] root: Client communication module connected
2021-03-18 22:45:05,814 DEBUG [Thread-8] root: {}
2021-03-18 22:45:05,814 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:45:06,326 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,327 INFO  [Thread-0] root: Connected to localhost on port 53070
2021-03-18 22:45:06,327 INFO  [Thread-9] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:45:06,328 INFO  [Thread-9] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:45:06,331 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,331 INFO  [Thread-0] root: Connected to localhost on port 53072
Starting commModule
2021-03-18 22:45:06,335 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,335 INFO  [Thread-0] root: Connected to localhost on port 53076
Starting commModule
2021-03-18 22:45:06,336 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,336 INFO  [Thread-0] root: Connected to localhost on port 53077
2021-03-18 22:45:06,337 INFO  [Thread-12] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:45:06,337 DEBUG [Thread-12] root: Getting successors
2021-03-18 22:45:06,337 DEBUG [Thread-12] root: Got successors
2021-03-18 22:45:06,337 DEBUG [Thread-12] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 22:45:06,338 INFO  [Thread-12] root: Client communication module connected
2021-03-18 22:45:06,338 INFO  [Thread-12] root: Client communication module connected
2021-03-18 22:45:06,338 DEBUG [Thread-12] root: {}
2021-03-18 22:45:06,338 INFO  [Thread-12] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:45:06,347 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,347 INFO  [Thread-0] root: Connected to localhost on port 53084
2021-03-18 22:45:06,348 INFO  [Thread-13] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:45:06,349 INFO  [Thread-13] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:45:06,354 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,355 INFO  [Thread-0] root: Connected to localhost on port 53087
Starting commModule
2021-03-18 22:45:06,358 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,359 INFO  [Thread-0] root: Connected to localhost on port 53091
Starting commModule
2021-03-18 22:45:06,359 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,360 INFO  [Thread-0] root: Connected to localhost on port 53092
2021-03-18 22:45:06,360 INFO  [Thread-16] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:45:06,361 DEBUG [Thread-16] root: Getting successors
2021-03-18 22:45:06,361 DEBUG [Thread-16] root: Got successors
2021-03-18 22:45:06,361 DEBUG [Thread-16] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 22:45:06,361 INFO  [Thread-16] root: Client communication module connected
2021-03-18 22:45:06,362 INFO  [Thread-16] root: Client communication module connected
2021-03-18 22:45:06,362 DEBUG [Thread-16] root: {}
2021-03-18 22:45:06,362 INFO  [Thread-16] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:45:06,377 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:06,378 INFO  [Thread-0] root: Connected to localhost on port 53100
2021-03-18 22:45:06,378 INFO  [Thread-17] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 22:45:06,378 DEBUG [Thread-17] root: Closing the program
2021-03-18 22:45:06,378 INFO  [Thread-17] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 22:45:06,379 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 22:45:06,380 INFO  [Thread-0] root: Server stopped.
2021-03-18 22:45:06,381 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 22:45:14,475 INFO  [Thread-0] root: Initialize server ...
2021-03-18 22:45:14,495 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 22:45:14,525 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 22:45:14,525 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 22:45:14,525 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 22:45:14,526 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 22:45:14,527 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 22:45:14,530 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7a8d20e7
2021-03-18 22:45:14,534 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 22:45:14,550 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 22:45:14,559 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 22:45:14,572 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 22:45:14,574 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/127.0.0.1:2181.
2021-03-18 22:45:14,574 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 22:45:14,593 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /127.0.0.1:53155, server: localhost/127.0.0.1:2181
2021-03-18 22:45:14,593 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/127.0.0.1:2181
2021-03-18 22:45:14,622 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,ffffff92,0,0,0,10,7d,ffffffec,60,2b,d,ffffffdb,ffffffd2,31,34,ffffffd0,fffffff2,26,ffffffb6,ffffffa6,45,6f,0,]
2021-03-18 22:45:14,624 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, session id = 0x10014bd52700092, negotiated timeout = 4000
2021-03-18 22:45:14,626 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:45:14,626 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 22:45:14,655 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700092, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,485,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 22:45:14,659 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700092, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,485,0  request:: '/keeper/server2,T  response:: s{485,485,1616121914626,1616121914626,0,0,0,72080397402374290,0,0,485} 
2021-03-18 22:45:14,686 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700092
2021-03-18 22:45:14,688 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd52700092
2021-03-18 22:45:14,689 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 22:45:14,689 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 22:45:14,690 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700092, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,486,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{485,486,1616121914626,1616121914660,1,0,0,72080397402374290,15,0,485} 
2021-03-18 22:45:14,690 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 22:45:14,698 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,699 INFO  [Thread-0] root: Connected to localhost on port 53156
2021-03-18 22:45:14,708 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 22:45:14,709 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 22:45:14,710 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 22:45:14,710 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 22:45:14,724 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,725 INFO  [Thread-0] root: Connected to localhost on port 53161
Starting commModule
2021-03-18 22:45:14,733 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,734 INFO  [Thread-0] root: Connected to localhost on port 53168
Starting commModule
2021-03-18 22:45:14,736 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,737 INFO  [Thread-0] root: Connected to localhost on port 53170
Starting commModule
2021-03-18 22:45:14,750 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,751 INFO  [Thread-0] root: Connected to localhost on port 53174
2021-03-18 22:45:14,752 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 22:45:14,753 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 22:45:14,756 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,758 INFO  [Thread-0] root: Connected to localhost on port 53176
Starting commModule
2021-03-18 22:45:14,767 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,768 INFO  [Thread-0] root: Connected to localhost on port 53183
Starting commModule
2021-03-18 22:45:14,768 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,769 INFO  [Thread-0] root: Connected to localhost on port 53184
2021-03-18 22:45:14,770 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 22:45:14,775 DEBUG [Thread-8] root: Getting successors
2021-03-18 22:45:14,775 DEBUG [Thread-8] root: Got successors
2021-03-18 22:45:14,775 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 22:45:14,778 INFO  [Thread-8] root: Client communication module connected
2021-03-18 22:45:14,778 INFO  [Thread-8] root: Client communication module connected
2021-03-18 22:45:14,778 DEBUG [Thread-8] root: {}
2021-03-18 22:45:14,779 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 22:45:14,787 INFO  [Thread-0] root: Server communication module connected
2021-03-18 22:45:14,788 INFO  [Thread-0] root: Connected to localhost on port 53190
2021-03-18 22:45:14,788 INFO  [Thread-9] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 22:45:14,789 DEBUG [Thread-9] root: Closing the program
2021-03-18 22:45:14,789 INFO  [Thread-9] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 22:45:14,790 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 22:45:14,792 INFO  [Thread-0] root: Server stopped.
2021-03-18 22:45:14,792 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 23:05:28,270 INFO  [Thread-0] root: Initialize server ...
2021-03-18 23:05:28,286 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 23:05:28,314 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 23:05:28,315 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 23:05:28,316 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 23:05:28,316 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 23:05:28,316 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 23:05:28,316 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 23:05:28,319 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@48a00dff
2021-03-18 23:05:28,324 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 23:05:28,337 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 23:05:28,345 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 23:05:28,355 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 23:05:28,357 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 23:05:28,357 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 23:05:28,376 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:53523, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 23:05:28,377 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 23:05:28,407 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,ffffffa7,0,0,0,10,72,ffffffc5,29,2a,2b,ffffff83,d,74,fffffffa,ffffffac,53,23,ffffff87,fffffffa,ffffff85,ffffffe4,0,]
2021-03-18 23:05:28,409 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527000a7, negotiated timeout = 4000
2021-03-18 23:05:28,411 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 23:05:28,411 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 23:05:28,438 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000a7, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,550,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 23:05:28,442 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000a7, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,550,0  request:: '/keeper/server2,T  response:: s{550,550,1616123128412,1616123128412,0,0,0,72080397402374311,0,0,550} 
2021-03-18 23:05:28,469 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527000a7
2021-03-18 23:05:28,470 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd527000a7
2021-03-18 23:05:28,471 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 23:05:28,471 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 23:05:28,472 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000a7, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,551,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{550,551,1616123128412,1616123128443,1,0,0,72080397402374311,15,0,550} 
2021-03-18 23:05:28,472 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 23:05:28,479 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,480 INFO  [Thread-0] root: Connected to localhost on port 53524
2021-03-18 23:05:28,488 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 23:05:28,489 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 23:05:28,489 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 23:05:28,489 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 23:05:28,501 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,502 INFO  [Thread-0] root: Connected to localhost on port 53529
Starting commModule
2021-03-18 23:05:28,509 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,510 INFO  [Thread-0] root: Connected to localhost on port 53536
Starting commModule
2021-03-18 23:05:28,512 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,512 INFO  [Thread-0] root: Connected to localhost on port 53538
Starting commModule
2021-03-18 23:05:28,521 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,522 INFO  [Thread-0] root: Connected to localhost on port 53542
2021-03-18 23:05:28,523 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:05:28,524 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:05:28,526 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,527 INFO  [Thread-0] root: Connected to localhost on port 53544
Starting commModule
2021-03-18 23:05:28,534 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,535 INFO  [Thread-0] root: Connected to localhost on port 53551
Starting commModule
2021-03-18 23:05:28,535 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,536 INFO  [Thread-0] root: Connected to localhost on port 53552
2021-03-18 23:05:28,537 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:05:28,541 DEBUG [Thread-8] root: Getting successors
2021-03-18 23:05:28,541 DEBUG [Thread-8] root: Got successors
2021-03-18 23:05:28,542 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 23:05:28,544 INFO  [Thread-8] root: Client communication module connected
2021-03-18 23:05:28,544 INFO  [Thread-8] root: Client communication module connected
2021-03-18 23:05:28,544 DEBUG [Thread-8] root: {}
2021-03-18 23:05:28,544 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:05:28,556 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:05:28,557 INFO  [Thread-0] root: Connected to localhost on port 53558
2021-03-18 23:05:28,557 INFO  [Thread-9] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 23:05:28,557 DEBUG [Thread-9] root: Closing the program
2021-03-18 23:05:28,557 INFO  [Thread-9] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 23:05:28,558 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 23:05:28,560 INFO  [Thread-0] root: Server stopped.
2021-03-18 23:05:28,560 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-18 23:06:24,575 INFO  [Thread-0] root: Initialize server ...
2021-03-18 23:06:24,588 INFO  [Thread-0] root: Server listening on port: 50001
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-18 23:06:24,610 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-18 23:06:24,611 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-18 23:06:24,614 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@777d7b53
2021-03-18 23:06:24,617 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-18 23:06:24,629 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-18 23:06:24,636 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-18 23:06:24,645 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-18 23:06:24,646 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-18 23:06:24,646 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-18 23:06:24,662 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:53823, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 23:06:24,663 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-18 23:06:24,693 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,0,ffffffbe,0,0,0,10,ffffffc6,ffffff9b,5e,2a,ffffff8b,ffffffda,33,8,5a,52,ffffffb2,ffffff9c,16,2b,ffffffcd,ffffffae,0,]
2021-03-18 23:06:24,695 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527000be, negotiated timeout = 4000
2021-03-18 23:06:24,698 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 23:06:24,698 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-18 23:06:24,728 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000be, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,612,0  request:: '/keeper/server2,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server2 
2021-03-18 23:06:24,733 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000be, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,612,0  request:: '/keeper/server2,T  response:: s{612,612,1616123184699,1616123184699,0,0,0,72080397402374334,0,0,612} 
2021-03-18 23:06:24,759 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527000be
2021-03-18 23:06:24,760 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2 for session id 0x10014bd527000be
2021-03-18 23:06:24,762 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-18 23:06:24,762 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server2
2021-03-18 23:06:24,762 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527000be, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,613,0  request:: '/keeper/server2,#3132372e302e302e313a3530303031,0  response:: s{612,613,1616123184699,1616123184734,1,0,0,72080397402374334,15,0,612} 
2021-03-18 23:06:24,763 INFO  [Thread-0] root: Node created at: /keeper/server2
Starting commModule
2021-03-18 23:06:24,770 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:24,771 INFO  [Thread-0] root: Connected to localhost on port 53824
2021-03-18 23:06:24,779 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-18 23:06:24,780 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-18 23:06:24,780 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-18 23:06:24,780 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-18 23:06:24,781 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:24,782 INFO  [Thread-0] root: Connected to localhost on port 53825
2021-03-18 23:06:24,783 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:24,784 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:24,784 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:24,785 INFO  [Thread-0] root: Connected to localhost on port 53826
2021-03-18 23:06:24,786 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:24,790 DEBUG [Thread-3] root: Getting successors
2021-03-18 23:06:24,790 DEBUG [Thread-3] root: Got successors
2021-03-18 23:06:24,791 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50001
Starting commModule
2021-03-18 23:06:24,793 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:24,793 INFO  [Thread-3] root: Client communication module connected
2021-03-18 23:06:24,794 INFO  [Thread-0] root: Connected to localhost on port 53827
Starting commModule
2021-03-18 23:06:24,794 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:24,794 INFO  [Thread-3] root: Client communication module connected
2021-03-18 23:06:24,794 DEBUG [Thread-3] root: {}
2021-03-18 23:06:24,794 INFO  [Thread-0] root: Connected to localhost on port 53828
2021-03-18 23:06:24,794 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,335 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,336 INFO  [Thread-0] root: Connected to localhost on port 53832
2021-03-18 23:06:25,337 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:25,337 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,338 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,339 INFO  [Thread-0] root: Connected to localhost on port 53833
2021-03-18 23:06:25,339 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:25,340 DEBUG [Thread-7] root: Getting successors
2021-03-18 23:06:25,340 DEBUG [Thread-7] root: Got successors
2021-03-18 23:06:25,340 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50001
2021-03-18 23:06:25,340 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-18 23:06:25,340 INFO  [Thread-7] root: Client communication module connected
2021-03-18 23:06:25,341 DEBUG [Thread-7] root: {}
2021-03-18 23:06:25,340 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,341 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-18 23:06:25,341 INFO  [Thread-0] root: Connected to localhost on port 53835
Starting commModule
2021-03-18 23:06:25,341 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,342 INFO  [Thread-0] root: Connected to localhost on port 53836
2021-03-18 23:06:25,342 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-18 23:06:25,342 DEBUG [Thread-9] root: Input data: 
2021-03-18 23:06:25,342 DEBUG [Thread-9] root: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-18 23:06:25,342 DEBUG [Thread-9] root: 127.0.0.1:50003
2021-03-18 23:06:25,343 INFO  [Thread-9] root: Client communication module connected
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Port: 50003
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Range: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Starting flush data
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Finished flush data
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Closing conn
2021-03-18 23:06:25,343 INFO  [Thread-9] root: Connection closed!
2021-03-18 23:06:25,343 DEBUG [Thread-9] root: Closed conn
2021-03-18 23:06:25,344 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-18 23:06:25,344 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,345 INFO  [Thread-0] root: Connected to localhost on port 53838
2021-03-18 23:06:25,345 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:25,346 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,350 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,350 INFO  [Thread-0] root: Connected to localhost on port 53840
2021-03-18 23:06:25,351 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:25,351 DEBUG [Thread-11] root: Getting successors
2021-03-18 23:06:25,351 DEBUG [Thread-11] root: Got successors
2021-03-18 23:06:25,351 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50001
2021-03-18 23:06:25,352 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-18 23:06:25,352 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,352 INFO  [Thread-11] root: Client communication module connected
2021-03-18 23:06:25,352 DEBUG [Thread-11] root: {}
2021-03-18 23:06:25,353 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-18 23:06:25,353 INFO  [Thread-0] root: Connected to localhost on port 53842
Starting commModule
2021-03-18 23:06:25,362 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,363 INFO  [Thread-0] root: Connected to localhost on port 53844
Starting commModule
2021-03-18 23:06:25,914 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,915 INFO  [Thread-0] root: Connected to localhost on port 53849
2021-03-18 23:06:25,916 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:25,917 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,920 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,921 INFO  [Thread-0] root: Connected to localhost on port 53851
2021-03-18 23:06:25,921 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:25,922 DEBUG [Thread-15] root: Getting successors
2021-03-18 23:06:25,922 DEBUG [Thread-15] root: Got successors
2021-03-18 23:06:25,922 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-18 23:06:25,922 INFO  [Thread-15] root: Client communication module connected
2021-03-18 23:06:25,923 INFO  [Thread-15] root: Client communication module connected
2021-03-18 23:06:25,923 DEBUG [Thread-15] root: {}
2021-03-18 23:06:25,923 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,926 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,927 INFO  [Thread-0] root: Connected to localhost on port 53856
Starting commModule
2021-03-18 23:06:25,927 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,928 INFO  [Thread-0] root: Connected to localhost on port 53857
2021-03-18 23:06:25,928 INFO  [Thread-17] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-18 23:06:25,928 DEBUG [Thread-17] root: Input data: 
2021-03-18 23:06:25,928 DEBUG [Thread-17] root: a98109598267087dfc364fae4cf24579:b3638a32c297f43aa37e63bbd839fc7e
2021-03-18 23:06:25,928 DEBUG [Thread-17] root: 127.0.0.1:50002
2021-03-18 23:06:25,929 INFO  [Thread-17] root: Client communication module connected
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Host: 127.0.0.1
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Port: 50002
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Range: a98109598267087dfc364fae4cf24579:b3638a32c297f43aa37e63bbd839fc7e
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Starting flush data
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Finished flush data
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Closing conn
2021-03-18 23:06:25,929 INFO  [Thread-17] root: Connection closed!
2021-03-18 23:06:25,929 DEBUG [Thread-17] root: Closed conn
2021-03-18 23:06:25,929 INFO  [Thread-17] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-18 23:06:25,930 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,930 INFO  [Thread-0] root: Connected to localhost on port 53859
2021-03-18 23:06:25,931 INFO  [Thread-18] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:25,932 INFO  [Thread-18] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,938 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,938 INFO  [Thread-0] root: Connected to localhost on port 53862
2021-03-18 23:06:25,939 INFO  [Thread-19] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:25,939 DEBUG [Thread-19] root: Getting successors
2021-03-18 23:06:25,939 DEBUG [Thread-19] root: Got successors
2021-03-18 23:06:25,939 DEBUG [Thread-19] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-18 23:06:25,940 INFO  [Thread-19] root: Client communication module connected
2021-03-18 23:06:25,940 INFO  [Thread-19] root: Client communication module connected
2021-03-18 23:06:25,940 DEBUG [Thread-19] root: {}
2021-03-18 23:06:25,940 INFO  [Thread-19] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:06:25,943 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,944 INFO  [Thread-0] root: Connected to localhost on port 53867
Starting commModule
2021-03-18 23:06:25,953 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:25,954 INFO  [Thread-0] root: Connected to localhost on port 53869
2021-03-18 23:06:26,068 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd527000be after 0ms.
Starting commModule
2021-03-18 23:06:26,502 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,503 INFO  [Thread-0] root: Connected to localhost on port 53874
2021-03-18 23:06:26,504 INFO  [Thread-22] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:26,505 INFO  [Thread-22] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:26,511 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,512 INFO  [Thread-0] root: Connected to localhost on port 53877
2021-03-18 23:06:26,513 INFO  [Thread-23] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:26,513 DEBUG [Thread-23] root: Getting successors
2021-03-18 23:06:26,513 DEBUG [Thread-23] root: Got successors
2021-03-18 23:06:26,513 DEBUG [Thread-23] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 23:06:26,514 INFO  [Thread-23] root: Client communication module connected
2021-03-18 23:06:26,514 INFO  [Thread-23] root: Client communication module connected
2021-03-18 23:06:26,514 DEBUG [Thread-23] root: {}
2021-03-18 23:06:26,515 INFO  [Thread-23] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:06:26,518 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,519 INFO  [Thread-0] root: Connected to localhost on port 53882
Starting commModule
2021-03-18 23:06:26,521 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,522 INFO  [Thread-0] root: Connected to localhost on port 53884
Starting commModule
2021-03-18 23:06:26,526 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,527 INFO  [Thread-0] root: Connected to localhost on port 53888
2021-03-18 23:06:26,527 INFO  [Thread-26] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-18 23:06:26,528 INFO  [Thread-26] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-18 23:06:26,537 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,538 INFO  [Thread-0] root: Connected to localhost on port 53892
2021-03-18 23:06:26,538 INFO  [Thread-27] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-18 23:06:26,539 DEBUG [Thread-27] root: Getting successors
2021-03-18 23:06:26,539 DEBUG [Thread-27] root: Got successors
2021-03-18 23:06:26,539 DEBUG [Thread-27] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-18 23:06:26,539 INFO  [Thread-27] root: Client communication module connected
2021-03-18 23:06:26,540 INFO  [Thread-27] root: Client communication module connected
2021-03-18 23:06:26,540 DEBUG [Thread-27] root: {}
2021-03-18 23:06:26,540 INFO  [Thread-27] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-18 23:06:26,544 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,544 INFO  [Thread-0] root: Connected to localhost on port 53897
Starting commModule
2021-03-18 23:06:26,547 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,548 INFO  [Thread-0] root: Connected to localhost on port 53899
Starting commModule
2021-03-18 23:06:26,560 INFO  [Thread-0] root: Server communication module connected
2021-03-18 23:06:26,560 INFO  [Thread-0] root: Connected to localhost on port 53904
2021-03-18 23:06:26,560 INFO  [Thread-30] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-18 23:06:26,561 DEBUG [Thread-30] root: Closing the program
2021-03-18 23:06:26,561 INFO  [Thread-30] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-18 23:06:26,561 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-18 23:06:26,563 INFO  [Thread-0] root: Server stopped.
2021-03-18 23:06:26,563 INFO  [Thread-0] root: Clearing KV Storage...
