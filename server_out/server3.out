2021-03-19 11:49:00,775 INFO  [Thread-0] root: Initialize server ...
2021-03-19 11:49:00,787 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 11:49:00,804 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 11:49:00,805 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 11:49:00,808 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7a8d20e7
2021-03-19 11:49:00,811 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 11:49:00,821 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 11:49:00,826 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 11:49:00,834 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 11:49:00,835 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 11:49:00,836 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 11:49:00,849 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:57003, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:49:00,850 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:49:00,879 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,51,0,0,0,10,fffffff0,a,ffffffc7,2c,fffffff0,ffffffd5,ffffff9d,ffffffc8,ffffffc5,ffffffdb,57,ffffffcf,49,c,61,ffffff91,0,]
2021-03-19 11:49:00,882 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd52700151, negotiated timeout = 4000
2021-03-19 11:49:00,885 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:49:00,885 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 11:49:00,914 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700151, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1082,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 11:49:00,919 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700151, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1082,0  request:: '/keeper/server3,T  response:: s{1082,1082,1616168940885,1616168940885,0,0,0,72080397402374481,0,0,1082} 
2021-03-19 11:49:00,945 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700151
2021-03-19 11:49:00,946 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd52700151
2021-03-19 11:49:00,948 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:49:00,948 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 11:49:00,949 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700151, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1083,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1082,1083,1616168940885,1616168940919,1,0,0,72080397402374481,15,0,1082} 
2021-03-19 11:49:00,949 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 11:49:00,957 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:00,957 INFO  [Thread-0] root: Connected to localhost on port 57004
2021-03-19 11:49:00,965 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 11:49:00,966 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 11:49:00,967 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 11:49:00,967 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 11:49:00,967 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:00,968 INFO  [Thread-0] root: Connected to localhost on port 57005
2021-03-19 11:49:00,969 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:00,971 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:00,971 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:00,972 INFO  [Thread-0] root: Connected to localhost on port 57006
2021-03-19 11:49:00,973 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:00,977 DEBUG [Thread-3] root: Getting successors
2021-03-19 11:49:00,978 DEBUG [Thread-3] root: Got successors
2021-03-19 11:49:00,978 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50002 127.0.0.1:50002
Starting commModule
2021-03-19 11:49:00,980 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:00,980 INFO  [Thread-3] root: Client communication module connected
2021-03-19 11:49:00,981 INFO  [Thread-0] root: Connected to localhost on port 57007
Starting commModule
2021-03-19 11:49:00,981 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:00,981 INFO  [Thread-3] root: Client communication module connected
2021-03-19 11:49:00,981 DEBUG [Thread-3] root: {}
2021-03-19 11:49:00,982 INFO  [Thread-0] root: Connected to localhost on port 57008
2021-03-19 11:49:00,982 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:01,471 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,472 INFO  [Thread-0] root: Connected to localhost on port 57012
2021-03-19 11:49:01,473 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:01,474 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:01,474 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,475 INFO  [Thread-0] root: Connected to localhost on port 57013
2021-03-19 11:49:01,476 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:01,476 DEBUG [Thread-7] root: Getting successors
2021-03-19 11:49:01,476 DEBUG [Thread-7] root: Got successors
2021-03-19 11:49:01,476 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-19 11:49:01,476 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-19 11:49:01,477 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,477 INFO  [Thread-7] root: Client communication module connected
2021-03-19 11:49:01,477 DEBUG [Thread-7] root: {}
2021-03-19 11:49:01,477 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 11:49:01,477 INFO  [Thread-0] root: Connected to localhost on port 57015
Starting commModule
2021-03-19 11:49:01,478 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,478 INFO  [Thread-0] root: Connected to localhost on port 57016
2021-03-19 11:49:01,479 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 11:49:01,479 DEBUG [Thread-9] root: Input data: 
2021-03-19 11:49:01,479 DEBUG [Thread-9] root: b3638a32c297f43aa37e63bbd839fc7f:358343938402ebb5110716c6e836f5a2
2021-03-19 11:49:01,479 DEBUG [Thread-9] root: 127.0.0.1:50000
2021-03-19 11:49:01,479 INFO  [Thread-9] root: Client communication module connected
2021-03-19 11:49:01,479 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Port: 50000
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Range: b3638a32c297f43aa37e63bbd839fc7f:358343938402ebb5110716c6e836f5a2
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Starting flush data
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Finished flush data
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Closing conn
2021-03-19 11:49:01,480 INFO  [Thread-9] root: Connection closed!
2021-03-19 11:49:01,480 DEBUG [Thread-9] root: Closed conn
2021-03-19 11:49:01,480 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 11:49:01,481 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,482 INFO  [Thread-0] root: Connected to localhost on port 57018
2021-03-19 11:49:01,482 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:01,483 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:01,487 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,487 INFO  [Thread-0] root: Connected to localhost on port 57020
2021-03-19 11:49:01,488 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:01,488 DEBUG [Thread-11] root: Getting successors
2021-03-19 11:49:01,488 DEBUG [Thread-11] root: Got successors
2021-03-19 11:49:01,488 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50002
2021-03-19 11:49:01,489 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-19 11:49:01,489 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,489 INFO  [Thread-11] root: Client communication module connected
2021-03-19 11:49:01,490 DEBUG [Thread-11] root: {}
2021-03-19 11:49:01,490 INFO  [Thread-0] root: Connected to localhost on port 57022
2021-03-19 11:49:01,490 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:01,500 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:01,501 INFO  [Thread-0] root: Connected to localhost on port 57024
Starting commModule
2021-03-19 11:49:02,064 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,065 INFO  [Thread-0] root: Connected to localhost on port 57029
2021-03-19 11:49:02,067 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:02,068 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,073 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,073 INFO  [Thread-0] root: Connected to localhost on port 57031
2021-03-19 11:49:02,074 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:02,075 DEBUG [Thread-15] root: Getting successors
2021-03-19 11:49:02,075 DEBUG [Thread-15] root: Got successors
2021-03-19 11:49:02,075 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-19 11:49:02,076 INFO  [Thread-15] root: Client communication module connected
2021-03-19 11:49:02,077 INFO  [Thread-15] root: Client communication module connected
2021-03-19 11:49:02,077 DEBUG [Thread-15] root: {}
2021-03-19 11:49:02,077 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,084 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,085 INFO  [Thread-0] root: Connected to localhost on port 57036
Starting commModule
2021-03-19 11:49:02,086 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,087 INFO  [Thread-0] root: Connected to localhost on port 57037
2021-03-19 11:49:02,087 INFO  [Thread-17] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 11:49:02,087 DEBUG [Thread-17] root: Input data: 
2021-03-19 11:49:02,087 DEBUG [Thread-17] root: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 11:49:02,087 DEBUG [Thread-17] root: 127.0.0.1:50003
2021-03-19 11:49:02,088 INFO  [Thread-17] root: Client communication module connected
2021-03-19 11:49:02,088 DEBUG [Thread-17] root: Host: 127.0.0.1
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Port: 50003
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Range: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Starting flush data
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Finished flush data
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Closing conn
2021-03-19 11:49:02,089 INFO  [Thread-17] root: Connection closed!
2021-03-19 11:49:02,089 DEBUG [Thread-17] root: Closed conn
2021-03-19 11:49:02,090 INFO  [Thread-17] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 11:49:02,091 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,092 INFO  [Thread-0] root: Connected to localhost on port 57039
2021-03-19 11:49:02,092 INFO  [Thread-18] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:02,093 INFO  [Thread-18] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,101 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,102 INFO  [Thread-0] root: Connected to localhost on port 57042
2021-03-19 11:49:02,103 INFO  [Thread-19] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:02,103 DEBUG [Thread-19] root: Getting successors
2021-03-19 11:49:02,103 DEBUG [Thread-19] root: Got successors
2021-03-19 11:49:02,103 DEBUG [Thread-19] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-19 11:49:02,104 INFO  [Thread-19] root: Client communication module connected
2021-03-19 11:49:02,105 INFO  [Thread-19] root: Client communication module connected
2021-03-19 11:49:02,105 DEBUG [Thread-19] root: {}
2021-03-19 11:49:02,105 INFO  [Thread-19] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,109 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,110 INFO  [Thread-0] root: Connected to localhost on port 57047
Starting commModule
2021-03-19 11:49:02,123 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,124 INFO  [Thread-0] root: Connected to localhost on port 57049
2021-03-19 11:49:02,254 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd52700151 after 0ms.
Starting commModule
2021-03-19 11:49:02,701 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,702 INFO  [Thread-0] root: Connected to localhost on port 57055
2021-03-19 11:49:02,703 INFO  [Thread-22] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:02,703 INFO  [Thread-22] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,711 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,711 INFO  [Thread-0] root: Connected to localhost on port 57058
2021-03-19 11:49:02,712 INFO  [Thread-23] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:02,712 DEBUG [Thread-23] root: Getting successors
2021-03-19 11:49:02,712 DEBUG [Thread-23] root: Got successors
2021-03-19 11:49:02,712 DEBUG [Thread-23] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:49:02,713 INFO  [Thread-23] root: Client communication module connected
2021-03-19 11:49:02,713 INFO  [Thread-23] root: Client communication module connected
2021-03-19 11:49:02,713 DEBUG [Thread-23] root: {}
2021-03-19 11:49:02,714 INFO  [Thread-23] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,717 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,719 INFO  [Thread-0] root: Connected to localhost on port 57063
Starting commModule
2021-03-19 11:49:02,721 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,721 INFO  [Thread-0] root: Connected to localhost on port 57065
Starting commModule
2021-03-19 11:49:02,726 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,727 INFO  [Thread-0] root: Connected to localhost on port 57069
2021-03-19 11:49:02,728 INFO  [Thread-26] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:02,729 INFO  [Thread-26] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,739 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,740 INFO  [Thread-0] root: Connected to localhost on port 57073
2021-03-19 11:49:02,740 INFO  [Thread-27] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:02,741 DEBUG [Thread-27] root: Getting successors
2021-03-19 11:49:02,741 DEBUG [Thread-27] root: Got successors
2021-03-19 11:49:02,741 DEBUG [Thread-27] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:49:02,741 INFO  [Thread-27] root: Client communication module connected
2021-03-19 11:49:02,742 INFO  [Thread-27] root: Client communication module connected
2021-03-19 11:49:02,742 DEBUG [Thread-27] root: {}
2021-03-19 11:49:02,742 INFO  [Thread-27] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:02,746 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,748 INFO  [Thread-0] root: Connected to localhost on port 57078
Starting commModule
2021-03-19 11:49:02,750 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,750 INFO  [Thread-0] root: Connected to localhost on port 57080
Starting commModule
2021-03-19 11:49:02,764 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:02,765 INFO  [Thread-0] root: Connected to localhost on port 57085
2021-03-19 11:49:02,765 INFO  [Thread-30] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 11:49:02,765 DEBUG [Thread-30] root: Closing the program
2021-03-19 11:49:02,765 INFO  [Thread-30] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 11:49:02,766 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 11:49:02,768 INFO  [Thread-0] root: Server stopped.
2021-03-19 11:49:02,768 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 11:49:08,787 INFO  [Thread-0] root: Initialize server ...
2021-03-19 11:49:08,799 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 11:49:08,817 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 11:49:08,818 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 11:49:08,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@403afac3
2021-03-19 11:49:08,824 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 11:49:08,834 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 11:49:08,842 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 11:49:08,856 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 11:49:08,859 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/127.0.0.1:2181.
2021-03-19 11:49:08,859 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 11:49:08,882 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /127.0.0.1:57093, server: localhost/127.0.0.1:2181
2021-03-19 11:49:08,885 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/127.0.0.1:2181
2021-03-19 11:49:08,915 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,57,0,0,0,10,16,4d,ffffffbb,2c,2f,6d,5c,52,ffffffb0,61,26,26,fffffff0,1d,ffffff8a,2b,0,]
2021-03-19 11:49:08,917 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, session id = 0x10014bd52700157, negotiated timeout = 4000
2021-03-19 11:49:08,920 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:49:08,920 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 11:49:08,949 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700157, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1100,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 11:49:08,955 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700157, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1100,0  request:: '/keeper/server3,T  response:: s{1100,1100,1616168948920,1616168948920,0,0,0,72080397402374487,0,0,1100} 
2021-03-19 11:49:08,984 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700157
2021-03-19 11:49:08,985 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd52700157
2021-03-19 11:49:08,987 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:49:08,987 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 11:49:08,988 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700157, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1101,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1100,1101,1616168948920,1616168948958,1,0,0,72080397402374487,15,0,1100} 
2021-03-19 11:49:08,988 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 11:49:09,000 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,002 INFO  [Thread-0] root: Connected to localhost on port 57094
2021-03-19 11:49:09,015 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 11:49:09,017 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 11:49:09,018 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 11:49:09,018 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 11:49:09,019 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,020 INFO  [Thread-0] root: Connected to localhost on port 57095
2021-03-19 11:49:09,021 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:09,023 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:09,024 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,025 INFO  [Thread-0] root: Connected to localhost on port 57096
2021-03-19 11:49:09,026 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:09,032 DEBUG [Thread-3] root: Getting successors
2021-03-19 11:49:09,032 DEBUG [Thread-3] root: Got successors
2021-03-19 11:49:09,032 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50002 127.0.0.1:50002
Starting commModule
2021-03-19 11:49:09,035 INFO  [Thread-3] root: Client communication module connected
2021-03-19 11:49:09,035 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,035 INFO  [Thread-0] root: Connected to localhost on port 57097
Starting commModule
2021-03-19 11:49:09,036 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,036 INFO  [Thread-3] root: Client communication module connected
2021-03-19 11:49:09,036 DEBUG [Thread-3] root: {}
2021-03-19 11:49:09,036 INFO  [Thread-0] root: Connected to localhost on port 57098
2021-03-19 11:49:09,036 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:09,626 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,627 INFO  [Thread-0] root: Connected to localhost on port 57102
2021-03-19 11:49:09,628 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:09,628 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:09,629 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,630 INFO  [Thread-0] root: Connected to localhost on port 57103
2021-03-19 11:49:09,631 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:09,631 DEBUG [Thread-7] root: Getting successors
2021-03-19 11:49:09,631 DEBUG [Thread-7] root: Got successors
2021-03-19 11:49:09,631 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-19 11:49:09,632 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-19 11:49:09,633 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,633 INFO  [Thread-7] root: Client communication module connected
2021-03-19 11:49:09,633 DEBUG [Thread-7] root: {}
2021-03-19 11:49:09,633 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 11:49:09,634 INFO  [Thread-0] root: Connected to localhost on port 57105
Starting commModule
2021-03-19 11:49:09,634 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,635 INFO  [Thread-0] root: Connected to localhost on port 57106
2021-03-19 11:49:09,635 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 11:49:09,635 DEBUG [Thread-9] root: Input data: 
2021-03-19 11:49:09,635 DEBUG [Thread-9] root: b3638a32c297f43aa37e63bbd839fc7f:a98109598267087dfc364fae4cf24578
2021-03-19 11:49:09,635 DEBUG [Thread-9] root: 127.0.0.1:50003
2021-03-19 11:49:09,636 INFO  [Thread-9] root: Client communication module connected
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Port: 50003
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Range: b3638a32c297f43aa37e63bbd839fc7f:a98109598267087dfc364fae4cf24578
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Starting flush data
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Finished flush data
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Closing conn
2021-03-19 11:49:09,636 INFO  [Thread-9] root: Connection closed!
2021-03-19 11:49:09,636 DEBUG [Thread-9] root: Closed conn
2021-03-19 11:49:09,637 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 11:49:09,638 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,638 INFO  [Thread-0] root: Connected to localhost on port 57108
2021-03-19 11:49:09,639 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:09,639 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:09,643 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,644 INFO  [Thread-0] root: Connected to localhost on port 57110
2021-03-19 11:49:09,644 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:09,645 DEBUG [Thread-11] root: Getting successors
2021-03-19 11:49:09,645 DEBUG [Thread-11] root: Got successors
2021-03-19 11:49:09,645 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-19 11:49:09,645 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-19 11:49:09,646 INFO  [Thread-11] root: Client communication module connected
2021-03-19 11:49:09,646 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,646 DEBUG [Thread-11] root: {}
2021-03-19 11:49:09,647 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 11:49:09,647 INFO  [Thread-0] root: Connected to localhost on port 57112
Starting commModule
2021-03-19 11:49:09,659 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:09,660 INFO  [Thread-0] root: Connected to localhost on port 57114
2021-03-19 11:49:10,296 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd52700157 after 1ms.
Starting commModule
2021-03-19 11:49:10,325 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,327 INFO  [Thread-0] root: Connected to localhost on port 57119
2021-03-19 11:49:10,328 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:10,329 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:10,334 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,335 INFO  [Thread-0] root: Connected to localhost on port 57121
2021-03-19 11:49:10,335 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:10,335 DEBUG [Thread-15] root: Getting successors
2021-03-19 11:49:10,335 DEBUG [Thread-15] root: Got successors
2021-03-19 11:49:10,336 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 11:49:10,336 INFO  [Thread-15] root: Client communication module connected
2021-03-19 11:49:10,337 INFO  [Thread-15] root: Client communication module connected
2021-03-19 11:49:10,337 DEBUG [Thread-15] root: {}
2021-03-19 11:49:10,337 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:10,342 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,343 INFO  [Thread-0] root: Connected to localhost on port 57125
Starting commModule
2021-03-19 11:49:10,349 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,351 INFO  [Thread-0] root: Connected to localhost on port 57129
2021-03-19 11:49:10,352 INFO  [Thread-17] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:10,353 INFO  [Thread-17] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:10,363 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,364 INFO  [Thread-0] root: Connected to localhost on port 57132
2021-03-19 11:49:10,364 INFO  [Thread-18] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:10,364 DEBUG [Thread-18] root: Getting successors
2021-03-19 11:49:10,365 DEBUG [Thread-18] root: Got successors
2021-03-19 11:49:10,365 DEBUG [Thread-18] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 11:49:10,365 INFO  [Thread-18] root: Client communication module connected
2021-03-19 11:49:10,366 INFO  [Thread-18] root: Client communication module connected
2021-03-19 11:49:10,366 DEBUG [Thread-18] root: {}
2021-03-19 11:49:10,366 INFO  [Thread-18] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:10,369 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,370 INFO  [Thread-0] root: Connected to localhost on port 57136
Starting commModule
2021-03-19 11:49:10,385 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:10,386 INFO  [Thread-0] root: Connected to localhost on port 57140
Starting commModule
2021-03-19 11:49:11,160 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,163 INFO  [Thread-0] root: Connected to localhost on port 57144
2021-03-19 11:49:11,166 INFO  [Thread-21] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:11,168 INFO  [Thread-21] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:11,194 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,196 INFO  [Thread-0] root: Connected to localhost on port 57147
2021-03-19 11:49:11,198 INFO  [Thread-22] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:11,198 DEBUG [Thread-22] root: Getting successors
2021-03-19 11:49:11,198 DEBUG [Thread-22] root: Got successors
2021-03-19 11:49:11,199 DEBUG [Thread-22] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:49:11,200 INFO  [Thread-22] root: Client communication module connected
2021-03-19 11:49:11,202 INFO  [Thread-22] root: Client communication module connected
2021-03-19 11:49:11,202 DEBUG [Thread-22] root: {}
2021-03-19 11:49:11,203 INFO  [Thread-22] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:11,208 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,209 INFO  [Thread-0] root: Connected to localhost on port 57151
Starting commModule
2021-03-19 11:49:11,232 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,233 INFO  [Thread-0] root: Connected to localhost on port 57158
2021-03-19 11:49:11,237 INFO  [Thread-24] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:49:11,240 INFO  [Thread-24] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:49:11,266 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,267 INFO  [Thread-0] root: Connected to localhost on port 57162
2021-03-19 11:49:11,269 INFO  [Thread-25] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:49:11,269 DEBUG [Thread-25] root: Getting successors
2021-03-19 11:49:11,269 DEBUG [Thread-25] root: Got successors
2021-03-19 11:49:11,269 DEBUG [Thread-25] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:49:11,270 INFO  [Thread-25] root: Client communication module connected
2021-03-19 11:49:11,271 INFO  [Thread-25] root: Client communication module connected
2021-03-19 11:49:11,271 DEBUG [Thread-25] root: {}
2021-03-19 11:49:11,272 INFO  [Thread-25] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:49:11,277 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,278 INFO  [Thread-0] root: Connected to localhost on port 57166
Starting commModule
2021-03-19 11:49:11,310 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,311 INFO  [Thread-0] root: Connected to localhost on port 57173
Starting commModule
2021-03-19 11:49:11,312 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:49:11,313 INFO  [Thread-0] root: Connected to localhost on port 57174
2021-03-19 11:49:11,314 INFO  [Thread-28] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 11:49:11,314 DEBUG [Thread-28] root: Closing the program
2021-03-19 11:49:11,315 INFO  [Thread-28] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 11:49:11,315 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 11:49:11,321 INFO  [Thread-0] root: Server stopped.
2021-03-19 11:49:11,322 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 11:58:47,311 INFO  [Thread-0] root: Initialize server ...
2021-03-19 11:58:47,323 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 11:58:47,340 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 11:58:47,340 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 11:58:47,340 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 11:58:47,340 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 11:58:47,340 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 11:58:47,341 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 11:58:47,344 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@24877fd5
2021-03-19 11:58:47,347 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 11:58:47,358 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 11:58:47,365 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 11:58:47,376 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 11:58:47,377 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 11:58:47,377 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 11:58:47,395 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:57498, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:58:47,396 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:58:47,425 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,72,0,0,0,10,1a,ffffffca,1c,2c,e,67,ffffffe9,ffffff95,ffffff8d,71,a,ffffffba,42,ffffff8c,ffffffb4,ffffffcc,0,]
2021-03-19 11:58:47,427 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd52700172, negotiated timeout = 4000
2021-03-19 11:58:47,430 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:58:47,430 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 11:58:47,458 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700172, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1187,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 11:58:47,462 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700172, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1187,0  request:: '/keeper/server3,T  response:: s{1187,1187,1616169527430,1616169527430,0,0,0,72080397402374514,0,0,1187} 
2021-03-19 11:58:47,489 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700172
2021-03-19 11:58:47,490 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd52700172
2021-03-19 11:58:47,491 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:58:47,491 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 11:58:47,492 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700172, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1188,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1187,1188,1616169527430,1616169527463,1,0,0,72080397402374514,15,0,1187} 
2021-03-19 11:58:47,492 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 11:58:47,499 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,500 INFO  [Thread-0] root: Connected to localhost on port 57499
2021-03-19 11:58:47,508 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 11:58:47,509 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 11:58:47,509 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 11:58:47,510 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 11:58:47,516 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,516 INFO  [Thread-0] root: Connected to localhost on port 57502
Starting commModule
2021-03-19 11:58:47,519 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,520 INFO  [Thread-0] root: Connected to localhost on port 57505
Starting commModule
2021-03-19 11:58:47,523 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,524 INFO  [Thread-0] root: Connected to localhost on port 57507
2021-03-19 11:58:47,525 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:47,526 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:47,528 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,529 INFO  [Thread-0] root: Connected to localhost on port 57509
Starting commModule
2021-03-19 11:58:47,530 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,530 INFO  [Thread-0] root: Connected to localhost on port 57511
2021-03-19 11:58:47,531 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:47,536 DEBUG [Thread-6] root: Getting successors
2021-03-19 11:58:47,536 DEBUG [Thread-6] root: Got successors
2021-03-19 11:58:47,537 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 11:58:47,539 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-19 11:58:47,540 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:47,540 INFO  [Thread-6] root: Client communication module connected
2021-03-19 11:58:47,540 DEBUG [Thread-6] root: {}
2021-03-19 11:58:47,540 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 11:58:47,540 INFO  [Thread-0] root: Connected to localhost on port 57513
Starting commModule
2021-03-19 11:58:48,084 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,085 INFO  [Thread-0] root: Connected to localhost on port 57518
2021-03-19 11:58:48,086 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:48,086 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,090 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,091 INFO  [Thread-0] root: Connected to localhost on port 57521
Starting commModule
2021-03-19 11:58:48,092 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,092 INFO  [Thread-0] root: Connected to localhost on port 57522
2021-03-19 11:58:48,093 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:48,094 DEBUG [Thread-10] root: Getting successors
2021-03-19 11:58:48,094 DEBUG [Thread-10] root: Got successors
2021-03-19 11:58:48,094 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 11:58:48,094 INFO  [Thread-10] root: Client communication module connected
2021-03-19 11:58:48,095 INFO  [Thread-10] root: Client communication module connected
2021-03-19 11:58:48,095 DEBUG [Thread-10] root: {}
2021-03-19 11:58:48,096 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,097 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,097 INFO  [Thread-0] root: Connected to localhost on port 57525
2021-03-19 11:58:48,098 INFO  [Thread-11] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 11:58:48,098 DEBUG [Thread-11] root: Input data: 
2021-03-19 11:58:48,098 DEBUG [Thread-11] root: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-19 11:58:48,098 DEBUG [Thread-11] root: 127.0.0.1:50003
2021-03-19 11:58:48,099 INFO  [Thread-11] root: Client communication module connected
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Host: 127.0.0.1
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Port: 50003
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Range: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Starting flush data
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Finished flush data
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Closing conn
2021-03-19 11:58:48,099 INFO  [Thread-11] root: Connection closed!
2021-03-19 11:58:48,099 DEBUG [Thread-11] root: Closed conn
2021-03-19 11:58:48,100 INFO  [Thread-11] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 11:58:48,103 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,104 INFO  [Thread-0] root: Connected to localhost on port 57528
2021-03-19 11:58:48,105 INFO  [Thread-12] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:48,106 INFO  [Thread-12] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,113 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,114 INFO  [Thread-0] root: Connected to localhost on port 57532
Starting commModule
2021-03-19 11:58:48,114 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,115 INFO  [Thread-0] root: Connected to localhost on port 57533
2021-03-19 11:58:48,116 INFO  [Thread-14] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:48,116 DEBUG [Thread-14] root: Getting successors
2021-03-19 11:58:48,116 DEBUG [Thread-14] root: Got successors
2021-03-19 11:58:48,116 DEBUG [Thread-14] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 11:58:48,116 INFO  [Thread-14] root: Client communication module connected
2021-03-19 11:58:48,117 INFO  [Thread-14] root: Client communication module connected
2021-03-19 11:58:48,117 DEBUG [Thread-14] root: {}
2021-03-19 11:58:48,117 INFO  [Thread-14] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,128 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,129 INFO  [Thread-0] root: Connected to localhost on port 57537
Starting commModule
2021-03-19 11:58:48,675 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,676 INFO  [Thread-0] root: Connected to localhost on port 57543
2021-03-19 11:58:48,677 INFO  [Thread-16] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:48,678 INFO  [Thread-16] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,685 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,686 INFO  [Thread-0] root: Connected to localhost on port 57548
2021-03-19 11:58:48,687 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:48,687 DEBUG [Thread-17] root: Getting successors
2021-03-19 11:58:48,687 DEBUG [Thread-17] root: Got successors
2021-03-19 11:58:48,687 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:58:48,688 INFO  [Thread-17] root: Client communication module connected
2021-03-19 11:58:48,690 INFO  [Thread-17] root: Client communication module connected
2021-03-19 11:58:48,690 DEBUG [Thread-17] root: {}
2021-03-19 11:58:48,691 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,694 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,695 INFO  [Thread-0] root: Connected to localhost on port 57552
Starting commModule
2021-03-19 11:58:48,703 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,703 INFO  [Thread-0] root: Connected to localhost on port 57557
2021-03-19 11:58:48,704 INFO  [Thread-19] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:48,705 INFO  [Thread-19] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,715 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,715 INFO  [Thread-0] root: Connected to localhost on port 57563
2021-03-19 11:58:48,716 INFO  [Thread-20] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:48,717 DEBUG [Thread-20] root: Getting successors
2021-03-19 11:58:48,717 DEBUG [Thread-20] root: Got successors
2021-03-19 11:58:48,717 DEBUG [Thread-20] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:58:48,717 INFO  [Thread-20] root: Client communication module connected
2021-03-19 11:58:48,718 INFO  [Thread-20] root: Client communication module connected
2021-03-19 11:58:48,718 DEBUG [Thread-20] root: {}
2021-03-19 11:58:48,718 INFO  [Thread-20] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:58:48,721 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,722 INFO  [Thread-0] root: Connected to localhost on port 57567
Starting commModule
2021-03-19 11:58:48,732 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,733 INFO  [Thread-0] root: Connected to localhost on port 57571
Starting commModule
2021-03-19 11:58:48,736 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:48,736 INFO  [Thread-0] root: Connected to localhost on port 57573
2021-03-19 11:58:48,736 INFO  [Thread-23] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 11:58:48,737 DEBUG [Thread-23] root: Closing the program
2021-03-19 11:58:48,737 INFO  [Thread-23] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 11:58:48,738 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 11:58:48,739 INFO  [Thread-0] root: Server stopped.
2021-03-19 11:58:48,739 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 11:58:56,517 INFO  [Thread-0] root: Initialize server ...
2021-03-19 11:58:56,530 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 11:58:56,553 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 11:58:56,553 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 11:58:56,553 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 11:58:56,554 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 11:58:56,555 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 11:58:56,558 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@48a00dff
2021-03-19 11:58:56,562 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 11:58:56,574 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 11:58:56,582 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 11:58:56,594 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 11:58:56,596 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 11:58:56,596 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 11:58:56,614 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:57628, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:58:56,615 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 11:58:56,644 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,7a,0,0,0,10,ffffffb3,ffffffd2,ffffffed,2b,e,ffffffc4,ffffffe3,ffffffbc,37,ffffff89,44,15,ffffffdf,ffffffd2,58,35,0,]
2021-03-19 11:58:56,646 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd5270017a, negotiated timeout = 4000
2021-03-19 11:58:56,649 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:58:56,649 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 11:58:56,677 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270017a, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1211,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 11:58:56,680 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270017a, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1211,0  request:: '/keeper/server3,T  response:: s{1211,1211,1616169536649,1616169536649,0,0,0,72080397402374522,0,0,1211} 
2021-03-19 11:58:56,706 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd5270017a
2021-03-19 11:58:56,707 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd5270017a
2021-03-19 11:58:56,709 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 11:58:56,709 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 11:58:56,709 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd5270017a, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1212,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1211,1212,1616169536649,1616169536681,1,0,0,72080397402374522,15,0,1211} 
2021-03-19 11:58:56,710 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 11:58:56,716 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,717 INFO  [Thread-0] root: Connected to localhost on port 57629
2021-03-19 11:58:56,725 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 11:58:56,726 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 11:58:56,726 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 11:58:56,726 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 11:58:56,739 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,740 INFO  [Thread-0] root: Connected to localhost on port 57635
Starting commModule
2021-03-19 11:58:56,742 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,743 INFO  [Thread-0] root: Connected to localhost on port 57637
Starting commModule
2021-03-19 11:58:56,748 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,749 INFO  [Thread-0] root: Connected to localhost on port 57643
Starting commModule
2021-03-19 11:58:56,758 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,758 INFO  [Thread-0] root: Connected to localhost on port 57647
2021-03-19 11:58:56,759 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 11:58:56,760 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 11:58:56,764 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,765 INFO  [Thread-0] root: Connected to localhost on port 57650
Starting commModule
2021-03-19 11:58:56,767 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,768 INFO  [Thread-0] root: Connected to localhost on port 57652
Starting commModule
2021-03-19 11:58:56,773 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,774 INFO  [Thread-0] root: Connected to localhost on port 57657
2021-03-19 11:58:56,775 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 11:58:56,780 DEBUG [Thread-8] root: Getting successors
2021-03-19 11:58:56,780 DEBUG [Thread-8] root: Got successors
2021-03-19 11:58:56,780 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 11:58:56,782 INFO  [Thread-8] root: Client communication module connected
2021-03-19 11:58:56,782 INFO  [Thread-8] root: Client communication module connected
2021-03-19 11:58:56,783 DEBUG [Thread-8] root: {}
2021-03-19 11:58:56,783 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 11:58:56,790 INFO  [Thread-0] root: Server communication module connected
2021-03-19 11:58:56,790 INFO  [Thread-0] root: Connected to localhost on port 57663
2021-03-19 11:58:56,791 INFO  [Thread-9] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 11:58:56,791 DEBUG [Thread-9] root: Closing the program
2021-03-19 11:58:56,791 INFO  [Thread-9] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 11:58:56,792 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 11:58:56,793 INFO  [Thread-0] root: Server stopped.
2021-03-19 11:58:56,793 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 15:29:06,789 INFO  [Thread-0] root: Initialize server ...
2021-03-19 15:29:06,801 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 15:29:06,820 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 15:29:06,821 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 15:29:06,824 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7a8d20e7
2021-03-19 15:29:06,827 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 15:29:06,837 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 15:29:06,843 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 15:29:06,851 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 15:29:06,852 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 15:29:06,853 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 15:29:06,869 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:59888, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 15:29:06,870 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 15:29:06,903 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,ffffff94,0,0,0,10,ffffffd6,ffffff9f,1c,31,ffffffd7,0,ffffffc3,ffffffef,ffffffb8,6c,1b,ffffffc4,b,8,38,29,0,]
2021-03-19 15:29:06,905 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd52700194, negotiated timeout = 4000
2021-03-19 15:29:06,908 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 15:29:06,908 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 15:29:06,959 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700194, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1295,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 15:29:06,964 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700194, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1295,0  request:: '/keeper/server3,T  response:: s{1295,1295,1616182146908,1616182146908,0,0,0,72080397402374548,0,0,1295} 
2021-03-19 15:29:06,990 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700194
2021-03-19 15:29:06,991 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd52700194
2021-03-19 15:29:06,993 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 15:29:06,993 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 15:29:06,994 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700194, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1296,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1295,1296,1616182146908,1616182146964,1,0,0,72080397402374548,15,0,1295} 
2021-03-19 15:29:06,994 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 15:29:07,001 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,002 INFO  [Thread-0] root: Connected to localhost on port 59889
2021-03-19 15:29:07,011 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 15:29:07,012 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 15:29:07,012 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 15:29:07,013 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 15:29:07,030 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,031 INFO  [Thread-0] root: Connected to localhost on port 59897
Starting commModule
2021-03-19 15:29:07,035 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,035 INFO  [Thread-0] root: Connected to localhost on port 59901
Starting commModule
2021-03-19 15:29:07,037 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,038 INFO  [Thread-0] root: Connected to localhost on port 59903
Starting commModule
2021-03-19 15:29:07,047 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,047 INFO  [Thread-0] root: Connected to localhost on port 59907
2021-03-19 15:29:07,048 INFO  [Thread-5] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:07,049 INFO  [Thread-5] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:07,056 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,056 INFO  [Thread-0] root: Connected to localhost on port 59912
Starting commModule
2021-03-19 15:29:07,060 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,060 INFO  [Thread-0] root: Connected to localhost on port 59916
Starting commModule
2021-03-19 15:29:07,061 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,061 INFO  [Thread-0] root: Connected to localhost on port 59917
2021-03-19 15:29:07,062 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:07,067 DEBUG [Thread-8] root: Getting successors
2021-03-19 15:29:07,067 DEBUG [Thread-8] root: Got successors
2021-03-19 15:29:07,068 DEBUG [Thread-8] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 15:29:07,070 INFO  [Thread-8] root: Client communication module connected
2021-03-19 15:29:07,071 INFO  [Thread-8] root: Client communication module connected
2021-03-19 15:29:07,071 DEBUG [Thread-8] root: {}
2021-03-19 15:29:07,071 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:07,079 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:07,079 INFO  [Thread-0] root: Connected to localhost on port 59923
2021-03-19 15:29:07,079 INFO  [Thread-9] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 15:29:07,080 DEBUG [Thread-9] root: Closing the program
2021-03-19 15:29:07,080 INFO  [Thread-9] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 15:29:07,081 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 15:29:07,082 INFO  [Thread-0] root: Server stopped.
2021-03-19 15:29:07,083 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 15:29:12,917 INFO  [Thread-0] root: Initialize server ...
2021-03-19 15:29:12,928 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 15:29:12,947 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 15:29:12,948 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 15:29:12,948 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 15:29:12,948 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 15:29:12,948 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 15:29:12,948 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 15:29:12,950 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@777d7b53
2021-03-19 15:29:12,954 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 15:29:12,965 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 15:29:12,972 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 15:29:12,982 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 15:29:12,984 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/127.0.0.1:2181.
2021-03-19 15:29:12,984 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 15:29:13,003 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /127.0.0.1:59927, server: localhost/127.0.0.1:2181
2021-03-19 15:29:13,004 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/127.0.0.1:2181
2021-03-19 15:29:13,034 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,ffffff97,0,0,0,10,ffffffc3,7e,22,31,37,ffffffb5,ffffffe3,ffffffaa,ffffffc3,29,ffffffb4,ffffff98,38,7f,23,5c,0,]
2021-03-19 15:29:13,036 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/127.0.0.1:2181, session id = 0x10014bd52700197, negotiated timeout = 4000
2021-03-19 15:29:13,040 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 15:29:13,040 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 15:29:13,068 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700197, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1304,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 15:29:13,072 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700197, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1304,0  request:: '/keeper/server3,T  response:: s{1304,1304,1616182153040,1616182153040,0,0,0,72080397402374551,0,0,1304} 
2021-03-19 15:29:13,100 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd52700197
2021-03-19 15:29:13,102 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd52700197
2021-03-19 15:29:13,103 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 15:29:13,103 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 15:29:13,104 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd52700197, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1305,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1304,1305,1616182153040,1616182153073,1,0,0,72080397402374551,15,0,1304} 
2021-03-19 15:29:13,104 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 15:29:13,113 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,114 INFO  [Thread-0] root: Connected to localhost on port 59928
2021-03-19 15:29:13,123 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 15:29:13,123 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 15:29:13,124 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 15:29:13,124 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 15:29:13,125 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,126 INFO  [Thread-0] root: Connected to localhost on port 59929
2021-03-19 15:29:13,127 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:13,129 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:13,129 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,130 INFO  [Thread-0] root: Connected to localhost on port 59930
2021-03-19 15:29:13,131 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:13,136 DEBUG [Thread-3] root: Getting successors
2021-03-19 15:29:13,136 DEBUG [Thread-3] root: Got successors
2021-03-19 15:29:13,136 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50002 127.0.0.1:50002
Starting commModule
2021-03-19 15:29:13,138 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,138 INFO  [Thread-3] root: Client communication module connected
2021-03-19 15:29:13,139 INFO  [Thread-0] root: Connected to localhost on port 59931
Starting commModule
2021-03-19 15:29:13,139 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,139 INFO  [Thread-3] root: Client communication module connected
2021-03-19 15:29:13,140 DEBUG [Thread-3] root: {}
2021-03-19 15:29:13,140 INFO  [Thread-0] root: Connected to localhost on port 59932
2021-03-19 15:29:13,140 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:13,758 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,759 INFO  [Thread-0] root: Connected to localhost on port 59936
2021-03-19 15:29:13,759 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:13,760 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:13,761 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,761 INFO  [Thread-0] root: Connected to localhost on port 59937
2021-03-19 15:29:13,762 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:13,762 DEBUG [Thread-7] root: Getting successors
2021-03-19 15:29:13,762 DEBUG [Thread-7] root: Got successors
2021-03-19 15:29:13,762 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 15:29:13,763 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-19 15:29:13,763 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,763 INFO  [Thread-7] root: Client communication module connected
2021-03-19 15:29:13,763 DEBUG [Thread-7] root: {}
2021-03-19 15:29:13,764 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 15:29:13,764 INFO  [Thread-0] root: Connected to localhost on port 59939
Starting commModule
2021-03-19 15:29:13,764 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,765 INFO  [Thread-0] root: Connected to localhost on port 59940
2021-03-19 15:29:13,765 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 15:29:13,765 DEBUG [Thread-9] root: Input data: 
2021-03-19 15:29:13,765 DEBUG [Thread-9] root: b3638a32c297f43aa37e63bbd839fc7f:dcee0277eb13b76434e8dcd31a387709
2021-03-19 15:29:13,765 DEBUG [Thread-9] root: 127.0.0.1:50001
2021-03-19 15:29:13,766 INFO  [Thread-9] root: Client communication module connected
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Port: 50001
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Range: b3638a32c297f43aa37e63bbd839fc7f:dcee0277eb13b76434e8dcd31a387709
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Starting flush data
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Finished flush data
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Closing conn
2021-03-19 15:29:13,766 INFO  [Thread-9] root: Connection closed!
2021-03-19 15:29:13,766 DEBUG [Thread-9] root: Closed conn
2021-03-19 15:29:13,767 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 15:29:13,767 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,768 INFO  [Thread-0] root: Connected to localhost on port 59942
2021-03-19 15:29:13,769 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:13,769 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:13,773 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,773 INFO  [Thread-0] root: Connected to localhost on port 59944
2021-03-19 15:29:13,774 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:13,774 DEBUG [Thread-11] root: Getting successors
2021-03-19 15:29:13,774 DEBUG [Thread-11] root: Got successors
2021-03-19 15:29:13,774 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 15:29:13,775 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-19 15:29:13,775 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,775 INFO  [Thread-11] root: Client communication module connected
2021-03-19 15:29:13,775 DEBUG [Thread-11] root: {}
2021-03-19 15:29:13,776 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 15:29:13,776 INFO  [Thread-0] root: Connected to localhost on port 59946
Starting commModule
2021-03-19 15:29:13,786 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:13,786 INFO  [Thread-0] root: Connected to localhost on port 59948
Starting commModule
2021-03-19 15:29:14,318 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,319 INFO  [Thread-0] root: Connected to localhost on port 59953
2021-03-19 15:29:14,320 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:14,321 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:14,325 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,325 INFO  [Thread-0] root: Connected to localhost on port 59955
2021-03-19 15:29:14,326 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:14,326 DEBUG [Thread-15] root: Getting successors
2021-03-19 15:29:14,326 DEBUG [Thread-15] root: Got successors
2021-03-19 15:29:14,327 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 15:29:14,327 INFO  [Thread-15] root: Client communication module connected
2021-03-19 15:29:14,328 INFO  [Thread-15] root: Client communication module connected
2021-03-19 15:29:14,328 DEBUG [Thread-15] root: {}
2021-03-19 15:29:14,328 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:14,334 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,334 INFO  [Thread-0] root: Connected to localhost on port 59960
Starting commModule
2021-03-19 15:29:14,335 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,335 INFO  [Thread-0] root: Connected to localhost on port 59961
2021-03-19 15:29:14,335 INFO  [Thread-17] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 15:29:14,335 DEBUG [Thread-17] root: Input data: 
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: 127.0.0.1:50000
2021-03-19 15:29:14,336 INFO  [Thread-17] root: Client communication module connected
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: Host: 127.0.0.1
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: Port: 50000
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: Range: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 15:29:14,336 DEBUG [Thread-17] root: Starting flush data
2021-03-19 15:29:14,337 DEBUG [Thread-17] root: Finished flush data
2021-03-19 15:29:14,337 DEBUG [Thread-17] root: Closing conn
2021-03-19 15:29:14,337 INFO  [Thread-17] root: Connection closed!
2021-03-19 15:29:14,337 DEBUG [Thread-17] root: Closed conn
2021-03-19 15:29:14,337 INFO  [Thread-17] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 15:29:14,338 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,339 INFO  [Thread-0] root: Connected to localhost on port 59963
2021-03-19 15:29:14,339 INFO  [Thread-18] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:14,340 INFO  [Thread-18] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:14,348 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,349 INFO  [Thread-0] root: Connected to localhost on port 59966
2021-03-19 15:29:14,350 INFO  [Thread-19] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:14,351 DEBUG [Thread-19] root: Getting successors
2021-03-19 15:29:14,351 DEBUG [Thread-19] root: Got successors
2021-03-19 15:29:14,351 DEBUG [Thread-19] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 15:29:14,352 INFO  [Thread-19] root: Client communication module connected
2021-03-19 15:29:14,352 INFO  [Thread-19] root: Client communication module connected
2021-03-19 15:29:14,352 DEBUG [Thread-19] root: {}
2021-03-19 15:29:14,353 INFO  [Thread-19] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:14,356 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,356 INFO  [Thread-0] root: Connected to localhost on port 59971
Starting commModule
2021-03-19 15:29:14,366 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:14,367 INFO  [Thread-0] root: Connected to localhost on port 59973
2021-03-19 15:29:14,412 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd52700197 after 0ms.
Starting commModule
2021-03-19 15:29:15,011 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,012 INFO  [Thread-0] root: Connected to localhost on port 59978
2021-03-19 15:29:15,013 INFO  [Thread-22] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:15,014 INFO  [Thread-22] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:15,021 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,022 INFO  [Thread-0] root: Connected to localhost on port 59981
2021-03-19 15:29:15,023 INFO  [Thread-23] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:15,023 DEBUG [Thread-23] root: Getting successors
2021-03-19 15:29:15,023 DEBUG [Thread-23] root: Got successors
2021-03-19 15:29:15,023 DEBUG [Thread-23] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 15:29:15,024 INFO  [Thread-23] root: Client communication module connected
2021-03-19 15:29:15,025 INFO  [Thread-23] root: Client communication module connected
2021-03-19 15:29:15,025 DEBUG [Thread-23] root: {}
2021-03-19 15:29:15,026 INFO  [Thread-23] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:15,045 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,046 INFO  [Thread-0] root: Connected to localhost on port 59989
Starting commModule
2021-03-19 15:29:15,047 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,050 INFO  [Thread-0] root: Connected to localhost on port 59990
2021-03-19 15:29:15,050 INFO  [Thread-25] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 15:29:15,051 DEBUG [Thread-25] root: Input data: 
2021-03-19 15:29:15,051 DEBUG [Thread-25] root: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 15:29:15,051 DEBUG [Thread-25] root: 127.0.0.1:50003
2021-03-19 15:29:15,052 INFO  [Thread-25] root: Client communication module connected
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Host: 127.0.0.1
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Port: 50003
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Range: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Starting flush data
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Finished flush data
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Closing conn
2021-03-19 15:29:15,052 INFO  [Thread-25] root: Connection closed!
2021-03-19 15:29:15,052 DEBUG [Thread-25] root: Closed conn
2021-03-19 15:29:15,053 INFO  [Thread-25] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 15:29:15,061 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,063 INFO  [Thread-0] root: Connected to localhost on port 59992
2021-03-19 15:29:15,064 INFO  [Thread-26] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 15:29:15,065 INFO  [Thread-26] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 15:29:15,078 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,079 INFO  [Thread-0] root: Connected to localhost on port 59996
2021-03-19 15:29:15,080 INFO  [Thread-27] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 15:29:15,080 DEBUG [Thread-27] root: Getting successors
2021-03-19 15:29:15,080 DEBUG [Thread-27] root: Got successors
2021-03-19 15:29:15,081 DEBUG [Thread-27] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 15:29:15,081 INFO  [Thread-27] root: Client communication module connected
2021-03-19 15:29:15,081 INFO  [Thread-27] root: Client communication module connected
2021-03-19 15:29:15,082 DEBUG [Thread-27] root: {}
2021-03-19 15:29:15,082 INFO  [Thread-27] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 15:29:15,091 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,093 INFO  [Thread-0] root: Connected to localhost on port 60004
Starting commModule
2021-03-19 15:29:15,106 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,107 INFO  [Thread-0] root: Connected to localhost on port 60006
Starting commModule
2021-03-19 15:29:15,108 INFO  [Thread-0] root: Server communication module connected
2021-03-19 15:29:15,110 INFO  [Thread-0] root: Connected to localhost on port 60008
2021-03-19 15:29:15,110 INFO  [Thread-30] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 15:29:15,110 DEBUG [Thread-30] root: Closing the program
2021-03-19 15:29:15,110 INFO  [Thread-30] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 15:29:15,111 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 15:29:15,114 INFO  [Thread-0] root: Server stopped.
2021-03-19 15:29:15,114 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 16:11:43,546 INFO  [Thread-0] root: Initialize server ...
2021-03-19 16:11:43,558 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 16:11:43,579 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 16:11:43,579 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 16:11:43,579 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 16:11:43,579 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 16:11:43,579 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 16:11:43,580 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 16:11:43,584 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@403afac3
2021-03-19 16:11:43,587 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 16:11:43,598 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 16:11:43,604 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 16:11:43,612 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 16:11:43,613 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 16:11:43,613 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 16:11:43,626 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:60994, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:11:43,627 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:11:43,656 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,ffffffbb,0,0,0,10,73,25,4f,30,ffffffb6,57,4a,5a,3f,ffffff94,39,ffffffb3,fffffffa,ffffffbc,6,33,0,]
2021-03-19 16:11:43,659 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527001bb, negotiated timeout = 4000
2021-03-19 16:11:43,662 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:11:43,662 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 16:11:43,690 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001bb, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1424,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 16:11:43,694 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001bb, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1424,0  request:: '/keeper/server3,T  response:: s{1424,1424,1616184703662,1616184703662,0,0,0,72080397402374587,0,0,1424} 
2021-03-19 16:11:43,721 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527001bb
2021-03-19 16:11:43,722 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd527001bb
2021-03-19 16:11:43,724 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:11:43,724 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 16:11:43,725 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001bb, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1425,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1424,1425,1616184703662,1616184703695,1,0,0,72080397402374587,15,0,1424} 
2021-03-19 16:11:43,725 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 16:11:43,732 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,733 INFO  [Thread-0] root: Connected to localhost on port 60995
2021-03-19 16:11:43,741 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 16:11:43,741 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 16:11:43,742 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 16:11:43,742 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 16:11:43,747 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,748 INFO  [Thread-0] root: Connected to localhost on port 60998
Starting commModule
2021-03-19 16:11:43,750 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,751 INFO  [Thread-0] root: Connected to localhost on port 61001
Starting commModule
2021-03-19 16:11:43,754 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,755 INFO  [Thread-0] root: Connected to localhost on port 61003
2021-03-19 16:11:43,756 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:43,757 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:43,760 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,761 INFO  [Thread-0] root: Connected to localhost on port 61005
Starting commModule
2021-03-19 16:11:43,762 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,762 INFO  [Thread-0] root: Connected to localhost on port 61007
2021-03-19 16:11:43,763 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:43,768 DEBUG [Thread-6] root: Getting successors
2021-03-19 16:11:43,768 DEBUG [Thread-6] root: Got successors
2021-03-19 16:11:43,769 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50003 127.0.0.1:50002
2021-03-19 16:11:43,771 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-19 16:11:43,772 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:43,772 INFO  [Thread-6] root: Client communication module connected
2021-03-19 16:11:43,772 DEBUG [Thread-6] root: {}
2021-03-19 16:11:43,772 INFO  [Thread-0] root: Connected to localhost on port 61009
2021-03-19 16:11:43,772 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,271 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,272 INFO  [Thread-0] root: Connected to localhost on port 61014
2021-03-19 16:11:44,273 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:44,273 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,276 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,277 INFO  [Thread-0] root: Connected to localhost on port 61016
Starting commModule
2021-03-19 16:11:44,277 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,278 INFO  [Thread-0] root: Connected to localhost on port 61018
2021-03-19 16:11:44,278 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:44,279 DEBUG [Thread-10] root: Getting successors
2021-03-19 16:11:44,279 DEBUG [Thread-10] root: Got successors
2021-03-19 16:11:44,279 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-19 16:11:44,279 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:11:44,280 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:11:44,280 DEBUG [Thread-10] root: {}
2021-03-19 16:11:44,280 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,286 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,286 INFO  [Thread-0] root: Connected to localhost on port 61024
2021-03-19 16:11:44,287 INFO  [Thread-11] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:44,288 INFO  [Thread-11] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,293 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,294 INFO  [Thread-0] root: Connected to localhost on port 61027
Starting commModule
2021-03-19 16:11:44,294 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,295 INFO  [Thread-0] root: Connected to localhost on port 61029
2021-03-19 16:11:44,296 INFO  [Thread-13] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:44,296 DEBUG [Thread-13] root: Getting successors
2021-03-19 16:11:44,296 DEBUG [Thread-13] root: Got successors
2021-03-19 16:11:44,296 DEBUG [Thread-13] root: Propagating to: 127.0.0.1:50000 127.0.0.1:50003
2021-03-19 16:11:44,296 INFO  [Thread-13] root: Client communication module connected
2021-03-19 16:11:44,297 INFO  [Thread-13] root: Client communication module connected
2021-03-19 16:11:44,297 DEBUG [Thread-13] root: {}
2021-03-19 16:11:44,297 INFO  [Thread-13] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,308 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,308 INFO  [Thread-0] root: Connected to localhost on port 61034
Starting commModule
2021-03-19 16:11:44,810 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,811 INFO  [Thread-0] root: Connected to localhost on port 61039
2021-03-19 16:11:44,812 INFO  [Thread-15] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:44,813 INFO  [Thread-15] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,818 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,819 INFO  [Thread-0] root: Connected to localhost on port 61042
Starting commModule
2021-03-19 16:11:44,820 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,820 INFO  [Thread-0] root: Connected to localhost on port 61044
2021-03-19 16:11:44,821 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:44,821 DEBUG [Thread-17] root: Getting successors
2021-03-19 16:11:44,821 DEBUG [Thread-17] root: Got successors
2021-03-19 16:11:44,821 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:44,822 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:11:44,822 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:11:44,822 DEBUG [Thread-17] root: {}
2021-03-19 16:11:44,822 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,825 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,826 INFO  [Thread-0] root: Connected to localhost on port 61049
Starting commModule
2021-03-19 16:11:44,831 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,831 INFO  [Thread-0] root: Connected to localhost on port 61053
2021-03-19 16:11:44,832 INFO  [Thread-19] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:44,833 INFO  [Thread-19] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,841 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,842 INFO  [Thread-0] root: Connected to localhost on port 61057
Starting commModule
2021-03-19 16:11:44,842 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,843 INFO  [Thread-0] root: Connected to localhost on port 61059
2021-03-19 16:11:44,844 INFO  [Thread-21] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:44,844 DEBUG [Thread-21] root: Getting successors
2021-03-19 16:11:44,844 DEBUG [Thread-21] root: Got successors
2021-03-19 16:11:44,844 DEBUG [Thread-21] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:44,845 INFO  [Thread-21] root: Client communication module connected
2021-03-19 16:11:44,845 INFO  [Thread-21] root: Client communication module connected
2021-03-19 16:11:44,845 DEBUG [Thread-21] root: {}
2021-03-19 16:11:44,845 INFO  [Thread-21] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:44,849 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,850 INFO  [Thread-0] root: Connected to localhost on port 61064
Starting commModule
2021-03-19 16:11:44,863 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:44,863 INFO  [Thread-23] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 16:11:44,863 INFO  [Thread-0] root: Connected to localhost on port 61069
2021-03-19 16:11:44,863 DEBUG [Thread-23] root: Closing the program
2021-03-19 16:11:44,864 INFO  [Thread-23] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 16:11:44,864 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 16:11:44,867 INFO  [Thread-0] root: Server stopped.
2021-03-19 16:11:44,867 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 16:11:51,170 INFO  [Thread-0] root: Initialize server ...
2021-03-19 16:11:51,190 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 16:11:51,224 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 16:11:51,224 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 16:11:51,225 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 16:11:51,226 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 16:11:51,226 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 16:11:51,226 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 16:11:51,226 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 16:11:51,226 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 16:11:51,233 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@9e7ffba
2021-03-19 16:11:51,238 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 16:11:51,257 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 16:11:51,269 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 16:11:51,287 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 16:11:51,289 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 16:11:51,289 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 16:11:51,317 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:61076, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:11:51,319 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:11:51,350 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,ffffffc0,0,0,0,10,ffffff82,71,5e,2f,54,74,d,62,ffffff86,4d,ffffffc3,ffffffa6,ffffffdf,ffffffa6,50,b,0,]
2021-03-19 16:11:51,353 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527001c0, negotiated timeout = 4000
2021-03-19 16:11:51,356 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:11:51,356 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 16:11:51,386 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001c0, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1439,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 16:11:51,391 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001c0, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1439,0  request:: '/keeper/server3,T  response:: s{1439,1439,1616184711357,1616184711357,0,0,0,72080397402374592,0,0,1439} 
2021-03-19 16:11:51,420 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527001c0
2021-03-19 16:11:51,421 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd527001c0
2021-03-19 16:11:51,423 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:11:51,424 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 16:11:51,425 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001c0, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1440,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1439,1440,1616184711357,1616184711393,1,0,0,72080397402374592,15,0,1439} 
2021-03-19 16:11:51,426 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 16:11:51,434 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:51,435 INFO  [Thread-0] root: Connected to localhost on port 61077
2021-03-19 16:11:51,443 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 16:11:51,444 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 16:11:51,444 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 16:11:51,445 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 16:11:51,445 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:51,446 INFO  [Thread-0] root: Connected to localhost on port 61078
2021-03-19 16:11:51,447 INFO  [Thread-2] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:51,448 INFO  [Thread-2] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:51,448 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:51,449 INFO  [Thread-0] root: Connected to localhost on port 61079
2021-03-19 16:11:51,450 INFO  [Thread-3] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:51,454 DEBUG [Thread-3] root: Getting successors
2021-03-19 16:11:51,454 DEBUG [Thread-3] root: Got successors
2021-03-19 16:11:51,455 DEBUG [Thread-3] root: Propagating to: 127.0.0.1:50002 127.0.0.1:50002
Starting commModule
2021-03-19 16:11:51,457 INFO  [Thread-3] root: Client communication module connected
2021-03-19 16:11:51,457 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:51,458 INFO  [Thread-0] root: Connected to localhost on port 61080
Starting commModule
2021-03-19 16:11:51,458 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:51,458 INFO  [Thread-3] root: Client communication module connected
2021-03-19 16:11:51,458 DEBUG [Thread-3] root: {}
2021-03-19 16:11:51,458 INFO  [Thread-0] root: Connected to localhost on port 61081
2021-03-19 16:11:51,459 INFO  [Thread-3] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,111 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,112 INFO  [Thread-0] root: Connected to localhost on port 61085
2021-03-19 16:11:52,113 INFO  [Thread-6] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:52,114 INFO  [Thread-6] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,116 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,118 INFO  [Thread-0] root: Connected to localhost on port 61086
2021-03-19 16:11:52,119 INFO  [Thread-7] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:52,119 DEBUG [Thread-7] root: Getting successors
2021-03-19 16:11:52,119 DEBUG [Thread-7] root: Got successors
2021-03-19 16:11:52,119 DEBUG [Thread-7] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 16:11:52,121 INFO  [Thread-7] root: Client communication module connected
Starting commModule
2021-03-19 16:11:52,122 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,122 INFO  [Thread-7] root: Client communication module connected
2021-03-19 16:11:52,122 DEBUG [Thread-7] root: {}
2021-03-19 16:11:52,124 INFO  [Thread-7] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 16:11:52,125 INFO  [Thread-0] root: Connected to localhost on port 61088
Starting commModule
2021-03-19 16:11:52,126 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,128 INFO  [Thread-9] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:11:52,128 INFO  [Thread-0] root: Connected to localhost on port 61089
2021-03-19 16:11:52,129 DEBUG [Thread-9] root: Input data: 
2021-03-19 16:11:52,129 DEBUG [Thread-9] root: b3638a32c297f43aa37e63bbd839fc7f:dcee0277eb13b76434e8dcd31a387709
2021-03-19 16:11:52,129 DEBUG [Thread-9] root: 127.0.0.1:50001
2021-03-19 16:11:52,130 INFO  [Thread-9] root: Client communication module connected
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Host: 127.0.0.1
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Port: 50001
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Range: b3638a32c297f43aa37e63bbd839fc7f:dcee0277eb13b76434e8dcd31a387709
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Starting flush data
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Finished flush data
2021-03-19 16:11:52,130 DEBUG [Thread-9] root: Closing conn
2021-03-19 16:11:52,130 INFO  [Thread-9] root: Connection closed!
2021-03-19 16:11:52,131 DEBUG [Thread-9] root: Closed conn
2021-03-19 16:11:52,131 INFO  [Thread-9] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:11:52,132 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,133 INFO  [Thread-0] root: Connected to localhost on port 61091
2021-03-19 16:11:52,134 INFO  [Thread-10] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:52,135 INFO  [Thread-10] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,142 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,145 INFO  [Thread-0] root: Connected to localhost on port 61093
2021-03-19 16:11:52,146 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:52,146 DEBUG [Thread-11] root: Getting successors
2021-03-19 16:11:52,146 DEBUG [Thread-11] root: Got successors
2021-03-19 16:11:52,146 DEBUG [Thread-11] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 16:11:52,148 INFO  [Thread-11] root: Client communication module connected
Starting commModule
2021-03-19 16:11:52,150 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,150 INFO  [Thread-11] root: Client communication module connected
2021-03-19 16:11:52,151 DEBUG [Thread-11] root: {}
2021-03-19 16:11:52,152 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS
2021-03-19 16:11:52,153 INFO  [Thread-0] root: Connected to localhost on port 61095
Starting commModule
2021-03-19 16:11:52,185 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,187 INFO  [Thread-0] root: Connected to localhost on port 61097
2021-03-19 16:11:52,733 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd527001c0 after 2ms.
Starting commModule
2021-03-19 16:11:52,797 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,799 INFO  [Thread-0] root: Connected to localhost on port 61102
2021-03-19 16:11:52,801 INFO  [Thread-14] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:52,802 INFO  [Thread-14] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,806 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,807 INFO  [Thread-0] root: Connected to localhost on port 61104
2021-03-19 16:11:52,808 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:52,808 DEBUG [Thread-15] root: Getting successors
2021-03-19 16:11:52,808 DEBUG [Thread-15] root: Got successors
2021-03-19 16:11:52,808 DEBUG [Thread-15] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:52,808 INFO  [Thread-15] root: Client communication module connected
2021-03-19 16:11:52,809 INFO  [Thread-15] root: Client communication module connected
2021-03-19 16:11:52,809 DEBUG [Thread-15] root: {}
2021-03-19 16:11:52,809 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,815 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,816 INFO  [Thread-0] root: Connected to localhost on port 61109
Starting commModule
2021-03-19 16:11:52,816 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,817 INFO  [Thread-0] root: Connected to localhost on port 61110
2021-03-19 16:11:52,817 INFO  [Thread-17] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:11:52,817 DEBUG [Thread-17] root: Input data: 
2021-03-19 16:11:52,817 DEBUG [Thread-17] root: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 16:11:52,817 DEBUG [Thread-17] root: 127.0.0.1:50000
2021-03-19 16:11:52,818 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Host: 127.0.0.1
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Port: 50000
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Range: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Starting flush data
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Finished flush data
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Closing conn
2021-03-19 16:11:52,818 INFO  [Thread-17] root: Connection closed!
2021-03-19 16:11:52,818 DEBUG [Thread-17] root: Closed conn
2021-03-19 16:11:52,819 INFO  [Thread-17] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:11:52,822 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,824 INFO  [Thread-0] root: Connected to localhost on port 61112
2021-03-19 16:11:52,825 INFO  [Thread-18] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:52,826 INFO  [Thread-18] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,836 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,838 INFO  [Thread-0] root: Connected to localhost on port 61115
2021-03-19 16:11:52,839 INFO  [Thread-19] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:52,840 DEBUG [Thread-19] root: Getting successors
2021-03-19 16:11:52,840 DEBUG [Thread-19] root: Got successors
2021-03-19 16:11:52,841 DEBUG [Thread-19] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:52,842 INFO  [Thread-19] root: Client communication module connected
2021-03-19 16:11:52,843 INFO  [Thread-19] root: Client communication module connected
2021-03-19 16:11:52,843 DEBUG [Thread-19] root: {}
2021-03-19 16:11:52,844 INFO  [Thread-19] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:52,848 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,848 INFO  [Thread-0] root: Connected to localhost on port 61120
Starting commModule
2021-03-19 16:11:52,862 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:52,864 INFO  [Thread-0] root: Connected to localhost on port 61122
Starting commModule
2021-03-19 16:11:53,387 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,387 INFO  [Thread-0] root: Connected to localhost on port 61127
2021-03-19 16:11:53,388 INFO  [Thread-22] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:53,389 INFO  [Thread-22] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:53,395 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,396 INFO  [Thread-0] root: Connected to localhost on port 61130
2021-03-19 16:11:53,396 INFO  [Thread-23] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:53,397 DEBUG [Thread-23] root: Getting successors
2021-03-19 16:11:53,397 DEBUG [Thread-23] root: Got successors
2021-03-19 16:11:53,397 DEBUG [Thread-23] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:53,397 INFO  [Thread-23] root: Client communication module connected
2021-03-19 16:11:53,398 INFO  [Thread-23] root: Client communication module connected
2021-03-19 16:11:53,398 DEBUG [Thread-23] root: {}
2021-03-19 16:11:53,398 INFO  [Thread-23] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:53,404 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,405 INFO  [Thread-0] root: Connected to localhost on port 61138
Starting commModule
2021-03-19 16:11:53,405 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,406 INFO  [Thread-0] root: Connected to localhost on port 61139
2021-03-19 16:11:53,406 INFO  [Thread-25] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:11:53,406 DEBUG [Thread-25] root: Input data: 
2021-03-19 16:11:53,406 DEBUG [Thread-25] root: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 16:11:53,406 DEBUG [Thread-25] root: 127.0.0.1:50003
2021-03-19 16:11:53,406 INFO  [Thread-25] root: Client communication module connected
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Host: 127.0.0.1
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Port: 50003
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Range: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Starting flush data
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Finished flush data
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Closing conn
2021-03-19 16:11:53,407 INFO  [Thread-25] root: Connection closed!
2021-03-19 16:11:53,407 DEBUG [Thread-25] root: Closed conn
2021-03-19 16:11:53,407 INFO  [Thread-25] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:11:53,408 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,409 INFO  [Thread-0] root: Connected to localhost on port 61141
2021-03-19 16:11:53,409 INFO  [Thread-26] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:11:53,410 INFO  [Thread-26] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:11:53,418 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,419 INFO  [Thread-0] root: Connected to localhost on port 61145
2021-03-19 16:11:53,419 INFO  [Thread-27] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:11:53,419 DEBUG [Thread-27] root: Getting successors
2021-03-19 16:11:53,420 DEBUG [Thread-27] root: Got successors
2021-03-19 16:11:53,420 DEBUG [Thread-27] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:11:53,420 INFO  [Thread-27] root: Client communication module connected
2021-03-19 16:11:53,421 INFO  [Thread-27] root: Client communication module connected
2021-03-19 16:11:53,421 DEBUG [Thread-27] root: {}
2021-03-19 16:11:53,421 INFO  [Thread-27] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:11:53,428 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,428 INFO  [Thread-0] root: Connected to localhost on port 61153
Starting commModule
2021-03-19 16:11:53,439 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,440 INFO  [Thread-0] root: Connected to localhost on port 61155
Starting commModule
2021-03-19 16:11:53,442 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:11:53,443 INFO  [Thread-0] root: Connected to localhost on port 61157
2021-03-19 16:11:53,443 INFO  [Thread-30] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 16:11:53,443 DEBUG [Thread-30] root: Closing the program
2021-03-19 16:11:53,444 INFO  [Thread-30] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 16:11:53,445 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 16:11:53,447 INFO  [Thread-0] root: Server stopped.
2021-03-19 16:11:53,447 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 16:18:55,518 INFO  [Thread-0] root: Initialize server ...
2021-03-19 16:18:55,530 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 16:18:55,548 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 16:18:55,549 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 16:18:55,552 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@48a00dff
2021-03-19 16:18:55,555 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 16:18:55,565 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 16:18:55,572 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 16:18:55,585 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 16:18:55,587 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 16:18:55,587 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 16:18:55,603 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:62783, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:18:55,604 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:18:55,635 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,fffffff5,0,0,0,10,13,28,ffffffe3,2e,73,ffffffa8,5e,8,ffffffa4,ffffffcb,3b,36,3b,ffffffe0,ffffffff,ffffffdd,0,]
2021-03-19 16:18:55,636 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527001f5, negotiated timeout = 4000
2021-03-19 16:18:55,639 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:18:55,639 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 16:18:55,667 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f5, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1628,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 16:18:55,672 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f5, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1628,0  request:: '/keeper/server3,T  response:: s{1628,1628,1616185135639,1616185135639,0,0,0,72080397402374645,0,0,1628} 
2021-03-19 16:18:55,699 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527001f5
2021-03-19 16:18:55,700 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd527001f5
2021-03-19 16:18:55,701 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:18:55,701 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 16:18:55,702 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f5, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1629,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1628,1629,1616185135639,1616185135674,1,0,0,72080397402374645,15,0,1628} 
2021-03-19 16:18:55,702 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 16:18:55,709 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,710 INFO  [Thread-0] root: Connected to localhost on port 62784
2021-03-19 16:18:55,718 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 16:18:55,719 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 16:18:55,719 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 16:18:55,719 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 16:18:55,725 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,726 INFO  [Thread-0] root: Connected to localhost on port 62787
Starting commModule
2021-03-19 16:18:55,728 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,729 INFO  [Thread-0] root: Connected to localhost on port 62790
Starting commModule
2021-03-19 16:18:55,732 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,733 INFO  [Thread-0] root: Connected to localhost on port 62792
2021-03-19 16:18:55,733 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:18:55,734 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:18:55,737 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,738 INFO  [Thread-0] root: Connected to localhost on port 62794
Starting commModule
2021-03-19 16:18:55,738 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,739 INFO  [Thread-0] root: Connected to localhost on port 62796
2021-03-19 16:18:55,740 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:18:55,745 DEBUG [Thread-6] root: Getting successors
2021-03-19 16:18:55,745 DEBUG [Thread-6] root: Got successors
2021-03-19 16:18:55,745 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50059 127.0.0.1:50002
2021-03-19 16:18:55,747 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-19 16:18:55,748 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,748 INFO  [Thread-6] root: Client communication module connected
2021-03-19 16:18:55,748 DEBUG [Thread-6] root: {}
2021-03-19 16:18:55,748 INFO  [Thread-0] root: Connected to localhost on port 62798
2021-03-19 16:18:55,748 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:18:55,765 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,765 INFO  [Thread-0] root: Connected to localhost on port 62800
2021-03-19 16:18:55,768 INFO  [Thread-8] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: In serve
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: Checking if stopped or write locked
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: Case propagate
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: Passing to server
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: Getting Predecessors
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,768 DEBUG [Thread-8] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,769 DEBUG [Thread-8] root: Predecessors:
2021-03-19 16:18:55,769 DEBUG [Thread-8] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,769 DEBUG [Thread-8] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,769 DEBUG [Thread-8] root: Index of predecessor: 1
2021-03-19 16:18:55,769 DEBUG [Thread-8] root: Server Stuff
2021-03-19 16:18:55,769 INFO  [Thread-8] root: Put: key = k1, value = v1
2021-03-19 16:18:55,770 INFO  [Thread-8] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,772 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,773 INFO  [Thread-0] root: Connected to localhost on port 62802
2021-03-19 16:18:55,773 INFO  [Thread-9] root: Message received by server -> Status: GET_METADATA Key: nothing Value: nothing
2021-03-19 16:18:55,773 DEBUG [Thread-9] root: In serve
2021-03-19 16:18:55,773 DEBUG [Thread-9] root: Checking if stopped or write locked
2021-03-19 16:18:55,774 DEBUG [Thread-9] root: Case GET_METADATA
2021-03-19 16:18:55,782 INFO  [Thread-9] root: Message sent by server -> Status: GET_METADATA_SUCCESS Key: nothing Value: nothing
2021-03-19 16:18:55,782 INFO  [Thread-9] root: Message received by server -> Status: PUT Key: k2 Value: v2
2021-03-19 16:18:55,782 DEBUG [Thread-9] root: In serve
2021-03-19 16:18:55,782 DEBUG [Thread-9] root: Checking if stopped or write locked
2021-03-19 16:18:55,782 DEBUG [Thread-9] root: PUT request being served
2021-03-19 16:18:55,782 DEBUG [Thread-9] root: Checking if it's in range
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: Got hostname and port -> 127.0.0.1:50002
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: Got metadata range: 6644acd684155ed59c07cdb5c5ee2ed:b3638a32c297f43aa37e63bbd839fc7e
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: 127.0.0.1:50059 -> b3638a32c297f43aa37e63bbd839fc7f:6644acd684155ed59c07cdb5c5ee2ec
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: 127.0.0.1:50002 -> 6644acd684155ed59c07cdb5c5ee2ed:b3638a32c297f43aa37e63bbd839fc7e
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: Got range big ints
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: Range start < range end
2021-03-19 16:18:55,784 DEBUG [Thread-9] root: Done with range check in server
2021-03-19 16:18:55,785 DEBUG [Thread-9] root: In range
2021-03-19 16:18:55,785 INFO  [Thread-9] root: Put: key = k2, value = v2
2021-03-19 16:18:55,785 DEBUG [Thread-9] root: Getting successors
2021-03-19 16:18:55,785 DEBUG [Thread-9] root: Got successors
2021-03-19 16:18:55,785 DEBUG [Thread-9] root: Propagating to: 127.0.0.1:50059 127.0.0.1:50002
2021-03-19 16:18:55,786 INFO  [Thread-9] root: Client communication module connected
Starting commModule
2021-03-19 16:18:55,786 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,786 INFO  [Thread-9] root: Client communication module connected
2021-03-19 16:18:55,787 DEBUG [Thread-9] root: {"k2":"v2"}
2021-03-19 16:18:55,787 INFO  [Thread-0] root: Connected to localhost on port 62804
2021-03-19 16:18:55,787 INFO  [Thread-9] root: Message sent by client -> Status: PROPAGATE
2021-03-19 16:18:55,788 INFO  [Thread-9] root: Message sent by client -> Status: PROPAGATE
2021-03-19 16:18:55,789 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: In serve
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Checking if stopped or write locked
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Case propagate
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Passing to server
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Getting Predecessors
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,789 DEBUG [Thread-10] root: Predecessors:
2021-03-19 16:18:55,790 DEBUG [Thread-10] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,790 DEBUG [Thread-10] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,790 DEBUG [Thread-10] root: Index of predecessor: 0
2021-03-19 16:18:55,790 DEBUG [Thread-10] root: Server Stuff
2021-03-19 16:18:55,790 INFO  [Thread-10] root: Put: key = k2, value = v2
2021-03-19 16:18:55,791 INFO  [Thread-9] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,791 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,792 INFO  [Thread-9] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,792 INFO  [Thread-9] root: Message sent by server -> Status: PUT_SUCCESS Key: k2 Value: v2
Starting commModule
2021-03-19 16:18:55,798 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,799 INFO  [Thread-0] root: Connected to localhost on port 62806
2021-03-19 16:18:55,800 INFO  [Thread-11] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: In serve
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Checking if stopped or write locked
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Case propagate
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Passing to server
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Getting Predecessors
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Predecessors:
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Index of predecessor: 1
2021-03-19 16:18:55,800 DEBUG [Thread-11] root: Server Stuff
2021-03-19 16:18:55,801 INFO  [Thread-11] root: Put: key = k3, value = v3
2021-03-19 16:18:55,801 INFO  [Thread-11] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,805 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,806 INFO  [Thread-0] root: Connected to localhost on port 62808
2021-03-19 16:18:55,806 INFO  [Thread-12] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,806 DEBUG [Thread-12] root: In serve
2021-03-19 16:18:55,806 DEBUG [Thread-12] root: Checking if stopped or write locked
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Case propagate
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Passing to server
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Getting Predecessors
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Predecessors:
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Index of predecessor: 1
2021-03-19 16:18:55,807 DEBUG [Thread-12] root: Server Stuff
2021-03-19 16:18:55,807 INFO  [Thread-12] root: Put: key = k4, value = v4
2021-03-19 16:18:55,808 INFO  [Thread-12] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,817 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,818 INFO  [Thread-0] root: Connected to localhost on port 62810
2021-03-19 16:18:55,819 INFO  [Thread-13] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: In serve
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Checking if stopped or write locked
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Case propagate
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Passing to server
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Getting Predecessors
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Predecessors:
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Index of predecessor: 1
2021-03-19 16:18:55,819 DEBUG [Thread-13] root: Server Stuff
2021-03-19 16:18:55,820 INFO  [Thread-13] root: Delete: key = k1
2021-03-19 16:18:55,820 INFO  [Thread-13] root: Updating storage
2021-03-19 16:18:55,820 INFO  [Thread-13] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,822 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,823 INFO  [Thread-0] root: Connected to localhost on port 62812
2021-03-19 16:18:55,824 INFO  [Thread-14] root: Message received by server -> Status: GET_METADATA Key: nothing Value: nothing
2021-03-19 16:18:55,824 DEBUG [Thread-14] root: In serve
2021-03-19 16:18:55,824 DEBUG [Thread-14] root: Checking if stopped or write locked
2021-03-19 16:18:55,824 DEBUG [Thread-14] root: Case GET_METADATA
2021-03-19 16:18:55,824 INFO  [Thread-14] root: Message sent by server -> Status: GET_METADATA_SUCCESS Key: nothing Value: nothing
2021-03-19 16:18:55,824 INFO  [Thread-14] root: Message received by server -> Status: PUT Key: k2 Value: null
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: In serve
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Checking if stopped or write locked
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: PUT request being served
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Checking if it's in range
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Got hostname and port -> 127.0.0.1:50002
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Got metadata range: 6644acd684155ed59c07cdb5c5ee2ed:b3638a32c297f43aa37e63bbd839fc7e
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: 127.0.0.1:50059 -> b3638a32c297f43aa37e63bbd839fc7f:6644acd684155ed59c07cdb5c5ee2ec
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: 127.0.0.1:50002 -> 6644acd684155ed59c07cdb5c5ee2ed:b3638a32c297f43aa37e63bbd839fc7e
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Got range big ints
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Range start < range end
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: Done with range check in server
2021-03-19 16:18:55,825 DEBUG [Thread-14] root: In range
2021-03-19 16:18:55,826 INFO  [Thread-14] root: Delete: key = k2
2021-03-19 16:18:55,826 INFO  [Thread-14] root: Updating storage
2021-03-19 16:18:55,826 DEBUG [Thread-14] root: Getting successors
2021-03-19 16:18:55,826 DEBUG [Thread-14] root: Got successors
2021-03-19 16:18:55,826 DEBUG [Thread-14] root: Propagating to: 127.0.0.1:50059 127.0.0.1:50002
2021-03-19 16:18:55,826 INFO  [Thread-14] root: Client communication module connected
Starting commModule
2021-03-19 16:18:55,827 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,827 INFO  [Thread-14] root: Client communication module connected
2021-03-19 16:18:55,827 DEBUG [Thread-14] root: {"k2":null}
2021-03-19 16:18:55,827 INFO  [Thread-0] root: Connected to localhost on port 62814
2021-03-19 16:18:55,828 INFO  [Thread-14] root: Message sent by client -> Status: PROPAGATE
2021-03-19 16:18:55,828 INFO  [Thread-14] root: Message sent by client -> Status: PROPAGATE
2021-03-19 16:18:55,829 INFO  [Thread-15] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: In serve
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Checking if stopped or write locked
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Case propagate
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Passing to server
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Getting Predecessors
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Predecessors:
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Index of predecessor: 0
2021-03-19 16:18:55,829 DEBUG [Thread-15] root: Server Stuff
2021-03-19 16:18:55,830 INFO  [Thread-15] root: Delete: key = k2
2021-03-19 16:18:55,830 INFO  [Thread-14] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,830 INFO  [Thread-15] root: Updating storage
2021-03-19 16:18:55,830 INFO  [Thread-15] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,831 INFO  [Thread-14] root: Message received by client -> Status: PROPAGATE_SUCCESS Key: null Value: null
2021-03-19 16:18:55,831 INFO  [Thread-14] root: Message sent by server -> Status: DELETE_SUCCESS Key: k2 Value: null
Starting commModule
2021-03-19 16:18:55,835 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,836 INFO  [Thread-0] root: Connected to localhost on port 62816
2021-03-19 16:18:55,837 INFO  [Thread-16] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: In serve
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Checking if stopped or write locked
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Case propagate
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Passing to server
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Getting Predecessors
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Predecessors:
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Index of predecessor: 1
2021-03-19 16:18:55,837 DEBUG [Thread-16] root: Server Stuff
2021-03-19 16:18:55,837 INFO  [Thread-16] root: Delete: key = k3
2021-03-19 16:18:55,837 INFO  [Thread-16] root: Updating storage
2021-03-19 16:18:55,838 INFO  [Thread-16] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,840 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,841 INFO  [Thread-0] root: Connected to localhost on port 62818
2021-03-19 16:18:55,842 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: In serve
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Checking if stopped or write locked
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Case propagate
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Passing to server
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Getting Predecessors
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Looking for 127.0.0.1:50002
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: [127.0.0.1:50059, 127.0.0.1:50002]
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Predecessors:
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: [127.0.0.1:50002, 127.0.0.1:50059]
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Looking for 127.0.0.1:50059
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Index of predecessor: 1
2021-03-19 16:18:55,842 DEBUG [Thread-17] root: Server Stuff
2021-03-19 16:18:55,842 INFO  [Thread-17] root: Delete: key = k4
2021-03-19 16:18:55,843 INFO  [Thread-17] root: Updating storage
2021-03-19 16:18:55,843 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS Key: null Value: null
Starting commModule
2021-03-19 16:18:55,846 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:18:55,847 INFO  [Thread-0] root: Connected to localhost on port 62821
2021-03-19 16:18:55,847 INFO  [Thread-18] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 16:18:55,847 DEBUG [Thread-18] root: Closing the program
2021-03-19 16:18:55,847 INFO  [Thread-18] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 16:18:55,848 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 16:18:55,849 INFO  [Thread-0] root: Server stopped.
2021-03-19 16:18:55,849 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 16:19:01,616 INFO  [Thread-0] root: Initialize server ...
2021-03-19 16:19:01,628 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 16:19:01,646 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 16:19:01,647 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 16:19:01,648 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 16:19:01,648 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 16:19:01,648 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 16:19:01,648 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 16:19:01,651 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@7a8d20e7
2021-03-19 16:19:01,654 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 16:19:01,665 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 16:19:01,670 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 16:19:01,679 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 16:19:01,680 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 16:19:01,680 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 16:19:01,693 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:62832, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:19:01,694 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:19:01,724 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,fffffff9,0,0,0,10,5f,ffffffac,ffffffcb,2e,fffffff3,ffffffd6,ffffffdb,1b,79,ffffffd7,ffffffd8,ffffffe3,ffffff8a,3,52,12,0,]
2021-03-19 16:19:01,726 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527001f9, negotiated timeout = 4000
2021-03-19 16:19:01,729 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:19:01,729 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 16:19:01,758 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f9, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1638,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 16:19:01,762 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f9, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1638,0  request:: '/keeper/server3,T  response:: s{1638,1638,1616185141730,1616185141730,0,0,0,72080397402374649,0,0,1638} 
2021-03-19 16:19:01,789 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527001f9
2021-03-19 16:19:01,790 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd527001f9
2021-03-19 16:19:01,792 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:19:01,792 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 16:19:01,793 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001f9, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1639,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1638,1639,1616185141730,1616185141763,1,0,0,72080397402374649,15,0,1638} 
2021-03-19 16:19:01,793 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 16:19:01,800 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,801 INFO  [Thread-0] root: Connected to localhost on port 62833
2021-03-19 16:19:01,809 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 16:19:01,810 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 16:19:01,810 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 16:19:01,810 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 16:19:01,816 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,817 INFO  [Thread-0] root: Connected to localhost on port 62836
Starting commModule
2021-03-19 16:19:01,819 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,819 INFO  [Thread-0] root: Connected to localhost on port 62839
Starting commModule
2021-03-19 16:19:01,822 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,823 INFO  [Thread-0] root: Connected to localhost on port 62841
2021-03-19 16:19:01,824 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:01,825 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:01,827 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,828 INFO  [Thread-0] root: Connected to localhost on port 62843
Starting commModule
2021-03-19 16:19:01,829 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,829 INFO  [Thread-0] root: Connected to localhost on port 62845
2021-03-19 16:19:01,830 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:01,835 DEBUG [Thread-6] root: Getting successors
2021-03-19 16:19:01,835 DEBUG [Thread-6] root: Got successors
2021-03-19 16:19:01,835 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 16:19:01,837 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-19 16:19:01,838 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:01,838 INFO  [Thread-6] root: Client communication module connected
2021-03-19 16:19:01,838 DEBUG [Thread-6] root: {}
2021-03-19 16:19:01,838 INFO  [Thread-0] root: Connected to localhost on port 62847
2021-03-19 16:19:01,839 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,352 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,352 INFO  [Thread-0] root: Connected to localhost on port 62853
2021-03-19 16:19:02,353 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:02,354 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,357 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,357 INFO  [Thread-0] root: Connected to localhost on port 62856
Starting commModule
2021-03-19 16:19:02,357 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,358 INFO  [Thread-0] root: Connected to localhost on port 62857
2021-03-19 16:19:02,359 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:02,359 DEBUG [Thread-10] root: Getting successors
2021-03-19 16:19:02,359 DEBUG [Thread-10] root: Got successors
2021-03-19 16:19:02,359 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:02,359 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:19:02,360 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:19:02,360 DEBUG [Thread-10] root: {}
2021-03-19 16:19:02,360 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,361 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,361 INFO  [Thread-0] root: Connected to localhost on port 62860
2021-03-19 16:19:02,362 INFO  [Thread-11] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:19:02,362 DEBUG [Thread-11] root: Input data: 
2021-03-19 16:19:02,362 DEBUG [Thread-11] root: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 16:19:02,362 DEBUG [Thread-11] root: 127.0.0.1:50000
2021-03-19 16:19:02,362 INFO  [Thread-11] root: Client communication module connected
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Host: 127.0.0.1
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Port: 50000
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Range: dcee0277eb13b76434e8dcd31a38770a:358343938402ebb5110716c6e836f5a2
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Starting flush data
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Finished flush data
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Closing conn
2021-03-19 16:19:02,363 INFO  [Thread-11] root: Connection closed!
2021-03-19 16:19:02,363 DEBUG [Thread-11] root: Closed conn
2021-03-19 16:19:02,364 INFO  [Thread-11] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:19:02,367 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,368 INFO  [Thread-0] root: Connected to localhost on port 62863
2021-03-19 16:19:02,369 INFO  [Thread-12] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:02,369 INFO  [Thread-12] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,375 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,376 INFO  [Thread-0] root: Connected to localhost on port 62867
Starting commModule
2021-03-19 16:19:02,376 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,377 INFO  [Thread-0] root: Connected to localhost on port 62868
2021-03-19 16:19:02,378 INFO  [Thread-14] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:02,378 DEBUG [Thread-14] root: Getting successors
2021-03-19 16:19:02,378 DEBUG [Thread-14] root: Got successors
2021-03-19 16:19:02,378 DEBUG [Thread-14] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:02,378 INFO  [Thread-14] root: Client communication module connected
2021-03-19 16:19:02,379 INFO  [Thread-14] root: Client communication module connected
2021-03-19 16:19:02,379 DEBUG [Thread-14] root: {}
2021-03-19 16:19:02,379 INFO  [Thread-14] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,389 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,389 INFO  [Thread-0] root: Connected to localhost on port 62872
Starting commModule
2021-03-19 16:19:02,950 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,951 INFO  [Thread-0] root: Connected to localhost on port 62878
2021-03-19 16:19:02,952 INFO  [Thread-16] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:02,953 INFO  [Thread-16] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,961 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,962 INFO  [Thread-0] root: Connected to localhost on port 62883
2021-03-19 16:19:02,962 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:02,963 DEBUG [Thread-17] root: Getting successors
2021-03-19 16:19:02,963 DEBUG [Thread-17] root: Got successors
2021-03-19 16:19:02,963 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:02,963 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:19:02,964 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:19:02,964 DEBUG [Thread-17] root: {}
2021-03-19 16:19:02,964 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,968 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,969 INFO  [Thread-0] root: Connected to localhost on port 62888
Starting commModule
2021-03-19 16:19:02,969 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,970 INFO  [Thread-0] root: Connected to localhost on port 62889
2021-03-19 16:19:02,970 INFO  [Thread-19] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:19:02,970 DEBUG [Thread-19] root: Input data: 
2021-03-19 16:19:02,970 DEBUG [Thread-19] root: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 16:19:02,970 DEBUG [Thread-19] root: 127.0.0.1:50003
2021-03-19 16:19:02,971 INFO  [Thread-19] root: Client communication module connected
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Host: 127.0.0.1
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Port: 50003
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Range: 358343938402ebb5110716c6e836f5a3:a98109598267087dfc364fae4cf24578
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Starting flush data
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Finished flush data
2021-03-19 16:19:02,971 DEBUG [Thread-19] root: Closing conn
2021-03-19 16:19:02,971 INFO  [Thread-19] root: Connection closed!
2021-03-19 16:19:02,972 DEBUG [Thread-19] root: Closed conn
2021-03-19 16:19:02,972 INFO  [Thread-19] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:19:02,975 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,975 INFO  [Thread-0] root: Connected to localhost on port 62892
2021-03-19 16:19:02,976 INFO  [Thread-20] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:02,977 INFO  [Thread-20] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,987 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,988 INFO  [Thread-0] root: Connected to localhost on port 62898
2021-03-19 16:19:02,988 INFO  [Thread-21] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:02,989 DEBUG [Thread-21] root: Getting successors
2021-03-19 16:19:02,989 DEBUG [Thread-21] root: Got successors
2021-03-19 16:19:02,989 DEBUG [Thread-21] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:02,989 INFO  [Thread-21] root: Client communication module connected
2021-03-19 16:19:02,990 INFO  [Thread-21] root: Client communication module connected
2021-03-19 16:19:02,990 DEBUG [Thread-21] root: {}
2021-03-19 16:19:02,990 INFO  [Thread-21] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:02,993 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:02,994 INFO  [Thread-0] root: Connected to localhost on port 62903
Starting commModule
2021-03-19 16:19:03,006 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:03,007 INFO  [Thread-0] root: Connected to localhost on port 62905
Starting commModule
2021-03-19 16:19:03,010 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:03,011 INFO  [Thread-0] root: Connected to localhost on port 62908
2021-03-19 16:19:03,011 INFO  [Thread-24] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 16:19:03,011 DEBUG [Thread-24] root: Closing the program
2021-03-19 16:19:03,011 INFO  [Thread-24] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 16:19:03,012 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 16:19:03,014 INFO  [Thread-0] root: Server stopped.
2021-03-19 16:19:03,014 INFO  [Thread-0] root: Clearing KV Storage...
2021-03-19 16:19:09,555 INFO  [Thread-0] root: Initialize server ...
2021-03-19 16:19:09,569 INFO  [Thread-0] root: Server listening on port: 50002
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:zookeeper.version=3.6.2--803c7f1a12f85978cb049af5e4ef23bd8b688715, built on 09/04/2020 12:44 GMT
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:host.name=localhost
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.version=11.0.10
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.vendor=Azul Systems, Inc.
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.home=/Users/steve/Library/Java/JavaVirtualMachines/azul-11.0.10/Contents/Home
2021-03-19 16:19:09,589 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.class.path=/Users/steve/Desktop/UofT/year4/winter2021/ECE419/milestone3/m3-server.jar
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.library.path=/Users/steve/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.io.tmpdir=/var/folders/kz/3gb57nkn6ks6_07_dtt5lqvr0000gn/T/
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:java.compiler=<NA>
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.name=Mac OS X
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.arch=x86_64
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.version=10.16
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.name=steve
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.home=/Users/steve
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:user.dir=/Users/steve
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.free=249MB
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.max=4096MB
2021-03-19 16:19:09,590 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Client environment:os.memory.total=256MB
2021-03-19 16:19:09,593 INFO  [Thread-0] org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=3000 watcher=app_kvServer.KVServer$1@24877fd5
2021-03-19 16:19:09,596 INFO  [Thread-0] org.apache.zookeeper.common.X509Util: Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation
2021-03-19 16:19:09,606 INFO  [Thread-0] org.apache.zookeeper.ClientCnxnSocket: jute.maxbuffer value is 1048575 Bytes
2021-03-19 16:19:09,613 INFO  [Thread-0] org.apache.zookeeper.ClientCnxn: zookeeper.request.timeout value is 0. feature enabled=false
2021-03-19 16:19:09,623 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.SaslServerPrincipal: Canonicalized address to localhost
2021-03-19 16:19:09,624 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181.
2021-03-19 16:19:09,625 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: SASL config status: Will not attempt to authenticate using SASL (unknown error)
2021-03-19 16:19:09,639 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Socket connection established, initiating session, client: /0:0:0:0:0:0:0:1:62921, server: localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:19:09,640 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment request sent on localhost/0:0:0:0:0:0:0:1:2181
2021-03-19 16:19:09,670 TRACE [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxnSocket: readConnectResult 37 0x[0,0,0,0,0,0,f,ffffffa0,1,0,14,ffffffbd,52,70,1,ffffffff,0,0,0,10,ffffff86,ffffffee,ffffffbf,2e,33,6e,ffffff9a,ffffffa5,63,5d,ffffffa7,3a,31,15,7b,ffffffac,0,]
2021-03-19 16:19:09,672 INFO  [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Session establishment complete on server localhost/0:0:0:0:0:0:0:1:2181, session id = 0x10014bd527001ff, negotiated timeout = 4000
2021-03-19 16:19:09,675 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:19:09,675 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:None path:null
2021-03-19 16:19:09,704 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001ff, packet:: clientPath:null serverPath:null finished:false header:: 1,1  replyHeader:: 1,1656,0  request:: '/keeper/server3,,v{s{31,s{'world,'anyone}}},1  response:: '/keeper/server3 
2021-03-19 16:19:09,709 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001ff, packet:: clientPath:null serverPath:null finished:false header:: 2,3  replyHeader:: 2,1656,0  request:: '/keeper/server3,T  response:: s{1656,1656,1616185149675,1616185149675,0,0,0,72080397402374655,0,0,1656} 
2021-03-19 16:19:09,735 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got notification session id: 0x10014bd527001ff
2021-03-19 16:19:09,737 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3 for session id 0x10014bd527001ff
2021-03-19 16:19:09,738 DEBUG [Thread-0-EventThread] root: ZK event: 
2021-03-19 16:19:09,738 DEBUG [Thread-0-EventThread] root: WatchedEvent state:SyncConnected type:NodeDataChanged path:/keeper/server3
2021-03-19 16:19:09,739 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Reading reply session id: 0x10014bd527001ff, packet:: clientPath:null serverPath:null finished:false header:: 3,5  replyHeader:: 3,1657,0  request:: '/keeper/server3,#3132372e302e302e313a3530303032,0  response:: s{1656,1657,1616185149675,1616185149710,1,0,0,72080397402374655,15,0,1656} 
2021-03-19 16:19:09,739 INFO  [Thread-0] root: Node created at: /keeper/server3
Starting commModule
2021-03-19 16:19:09,747 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,748 INFO  [Thread-0] root: Connected to localhost on port 62922
2021-03-19 16:19:09,756 INFO  [Thread-1] root: Message received by server -> Status: INIT_SERVER
received adminmsg
2021-03-19 16:19:09,757 INFO  [Thread-1] root: Message sent by server -> Status: INIT_SERVER_SUCCESS
2021-03-19 16:19:09,757 INFO  [Thread-1] root: Message received by server -> Status: START
received adminmsg
2021-03-19 16:19:09,757 INFO  [Thread-1] root: Message sent by server -> Status: START_SUCCESS
Starting commModule
2021-03-19 16:19:09,762 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,763 INFO  [Thread-0] root: Connected to localhost on port 62925
Starting commModule
2021-03-19 16:19:09,766 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,766 INFO  [Thread-0] root: Connected to localhost on port 62928
Starting commModule
2021-03-19 16:19:09,770 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,770 INFO  [Thread-0] root: Connected to localhost on port 62930
2021-03-19 16:19:09,771 INFO  [Thread-4] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:09,772 INFO  [Thread-4] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:09,775 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,775 INFO  [Thread-0] root: Connected to localhost on port 62932
Starting commModule
2021-03-19 16:19:09,776 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,777 INFO  [Thread-0] root: Connected to localhost on port 62934
2021-03-19 16:19:09,777 INFO  [Thread-6] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:09,782 DEBUG [Thread-6] root: Getting successors
2021-03-19 16:19:09,782 DEBUG [Thread-6] root: Got successors
2021-03-19 16:19:09,782 DEBUG [Thread-6] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50002
2021-03-19 16:19:09,785 INFO  [Thread-6] root: Client communication module connected
Starting commModule
2021-03-19 16:19:09,786 INFO  [Thread-6] root: Client communication module connected
2021-03-19 16:19:09,786 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:09,786 DEBUG [Thread-6] root: {}
2021-03-19 16:19:09,786 INFO  [Thread-0] root: Connected to localhost on port 62936
2021-03-19 16:19:09,786 INFO  [Thread-6] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:10,322 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,323 INFO  [Thread-0] root: Connected to localhost on port 62941
2021-03-19 16:19:10,323 INFO  [Thread-8] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:10,324 INFO  [Thread-8] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:10,327 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,328 INFO  [Thread-0] root: Connected to localhost on port 62944
Starting commModule
2021-03-19 16:19:10,328 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,328 INFO  [Thread-0] root: Connected to localhost on port 62945
2021-03-19 16:19:10,329 INFO  [Thread-10] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:10,329 DEBUG [Thread-10] root: Getting successors
2021-03-19 16:19:10,329 DEBUG [Thread-10] root: Got successors
2021-03-19 16:19:10,329 DEBUG [Thread-10] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 16:19:10,330 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:19:10,330 INFO  [Thread-10] root: Client communication module connected
2021-03-19 16:19:10,330 DEBUG [Thread-10] root: {}
2021-03-19 16:19:10,331 INFO  [Thread-10] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:10,331 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,332 INFO  [Thread-0] root: Connected to localhost on port 62948
2021-03-19 16:19:10,332 INFO  [Thread-11] root: Message received by server -> Status: MOVE_DATA
received adminmsg
2021-03-19 16:19:10,332 DEBUG [Thread-11] root: Input data: 
2021-03-19 16:19:10,332 DEBUG [Thread-11] root: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-19 16:19:10,332 DEBUG [Thread-11] root: 127.0.0.1:50003
2021-03-19 16:19:10,333 INFO  [Thread-11] root: Client communication module connected
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Host: 127.0.0.1
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Port: 50003
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Range: dcee0277eb13b76434e8dcd31a38770a:a98109598267087dfc364fae4cf24578
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Starting flush data
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Finished flush data
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Closing conn
2021-03-19 16:19:10,333 INFO  [Thread-11] root: Connection closed!
2021-03-19 16:19:10,333 DEBUG [Thread-11] root: Closed conn
2021-03-19 16:19:10,334 INFO  [Thread-11] root: Message sent by server -> Status: MOVE_DATA_SUCCESS
Starting commModule
2021-03-19 16:19:10,337 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,341 INFO  [Thread-0] root: Connected to localhost on port 62951
2021-03-19 16:19:10,342 INFO  [Thread-12] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:10,342 INFO  [Thread-12] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:10,349 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,349 INFO  [Thread-0] root: Connected to localhost on port 62955
Starting commModule
2021-03-19 16:19:10,349 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,350 INFO  [Thread-0] root: Connected to localhost on port 62956
2021-03-19 16:19:10,351 INFO  [Thread-14] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:10,351 DEBUG [Thread-14] root: Getting successors
2021-03-19 16:19:10,351 DEBUG [Thread-14] root: Got successors
2021-03-19 16:19:10,351 DEBUG [Thread-14] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50003
2021-03-19 16:19:10,351 INFO  [Thread-14] root: Client communication module connected
2021-03-19 16:19:10,352 INFO  [Thread-14] root: Client communication module connected
2021-03-19 16:19:10,352 DEBUG [Thread-14] root: {}
2021-03-19 16:19:10,352 INFO  [Thread-14] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:10,363 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:10,364 INFO  [Thread-0] root: Connected to localhost on port 62960
2021-03-19 16:19:11,048 DEBUG [Thread-0-SendThread(localhost:2181)] org.apache.zookeeper.ClientCnxn: Got ping response for session id: 0x10014bd527001ff after 1ms.
Starting commModule
2021-03-19 16:19:11,072 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,073 INFO  [Thread-0] root: Connected to localhost on port 62966
2021-03-19 16:19:11,075 INFO  [Thread-16] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:11,076 INFO  [Thread-16] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:11,087 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,087 INFO  [Thread-0] root: Connected to localhost on port 62971
2021-03-19 16:19:11,088 INFO  [Thread-17] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:11,089 DEBUG [Thread-17] root: Getting successors
2021-03-19 16:19:11,089 DEBUG [Thread-17] root: Got successors
2021-03-19 16:19:11,089 DEBUG [Thread-17] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:11,089 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:19:11,090 INFO  [Thread-17] root: Client communication module connected
2021-03-19 16:19:11,090 DEBUG [Thread-17] root: {}
2021-03-19 16:19:11,090 INFO  [Thread-17] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:11,094 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,096 INFO  [Thread-0] root: Connected to localhost on port 62975
Starting commModule
2021-03-19 16:19:11,104 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,105 INFO  [Thread-0] root: Connected to localhost on port 62980
2021-03-19 16:19:11,105 INFO  [Thread-19] root: Message received by server -> Status: UPDATE
received adminmsg
2021-03-19 16:19:11,106 INFO  [Thread-19] root: Message sent by server -> Status: UPDATE_SUCCESS
Starting commModule
2021-03-19 16:19:11,117 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,118 INFO  [Thread-0] root: Connected to localhost on port 62986
2021-03-19 16:19:11,119 INFO  [Thread-20] root: Message received by server -> Status: PROPAGATE_ADMIN
received adminmsg
2021-03-19 16:19:11,119 DEBUG [Thread-20] root: Getting successors
2021-03-19 16:19:11,119 DEBUG [Thread-20] root: Got successors
2021-03-19 16:19:11,119 DEBUG [Thread-20] root: Propagating to: 127.0.0.1:50001 127.0.0.1:50000
2021-03-19 16:19:11,120 INFO  [Thread-20] root: Client communication module connected
2021-03-19 16:19:11,120 INFO  [Thread-20] root: Client communication module connected
2021-03-19 16:19:11,120 DEBUG [Thread-20] root: {}
2021-03-19 16:19:11,121 INFO  [Thread-20] root: Message sent by server -> Status: PROPAGATE_SUCCESS
Starting commModule
2021-03-19 16:19:11,125 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,125 INFO  [Thread-0] root: Connected to localhost on port 62990
Starting commModule
2021-03-19 16:19:11,142 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,143 INFO  [Thread-0] root: Connected to localhost on port 62994
Starting commModule
2021-03-19 16:19:11,146 INFO  [Thread-0] root: Server communication module connected
2021-03-19 16:19:11,147 INFO  [Thread-23] root: Message received by server -> Status: SHUTDOWN
received adminmsg
2021-03-19 16:19:11,147 INFO  [Thread-0] root: Connected to localhost on port 62996
2021-03-19 16:19:11,147 DEBUG [Thread-23] root: Closing the program
2021-03-19 16:19:11,148 INFO  [Thread-23] root: Message sent by server -> Status: SHUTDOWN_SUCCESS
2021-03-19 16:19:11,148 ERROR [Thread-0] root: Error! Unable to establish connection. 

java.net.SocketException: Socket closed
	at java.base/java.net.PlainSocketImpl.socketAccept(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)
	at app_kvServer.KVServer.run(KVServer.java:408)
2021-03-19 16:19:11,150 INFO  [Thread-0] root: Server stopped.
2021-03-19 16:19:11,151 INFO  [Thread-0] root: Clearing KV Storage...
